/*1298995112,169776066*/

if (window.CavalryLogger) { CavalryLogger.start_js(["7Ch5B"]); }

function KeyEventController(){this.handlers={};document.onkeyup=this.onkeyevent.bind(this,'onkeyup');document.onkeydown=this.onkeyevent.bind(this,'onkeydown');document.onkeypress=this.onkeyevent.bind(this,'onkeypress');}copy_properties(KeyEventController,{instance:null,getInstance:function(){return KeyEventController.instance||(KeyEventController.instance=new KeyEventController());},defaultFilter:function(event,a){event=$E(event);return KeyEventController.filterEventTypes(event,a)&&KeyEventController.filterEventTargets(event,a)&&KeyEventController.filterEventModifiers(event,a);},filterEventTypes:function(event,a){if(a==='onkeydown')return true;return false;},filterEventTargets:function(event,b){var a=$E(event).getTarget();if(DOM.isNode(a,['input','select','textarea','object','embed']))if(a.type!='checkbox'&&a.type!='radio'&&a.type!='submit')return false;return a.getAttribute('contentEditable')!='true';},filterEventModifiers:function(event,a){if(event.ctrlKey||event.altKey||event.metaKey||event.repeat)return false;return true;},registerKey:function(f,a,d,g){if(d===undefined)d=KeyEventController.defaultFilter;var b=KeyEventController.getInstance();var c=b.mapKey(f);if(is_empty(b.handlers))onleaveRegister(b.resetHandlers.bind(b));for(var e=0;e<c.length;e++){f=c[e];if(!b.handlers[f]||g)b.handlers[f]=[];b.handlers[f].push({callback:a,filter:d});}},keyCodeMap:{BACKSPACE:[8],TAB:[9],RETURN:[13],ESCAPE:[27],LEFT:[37,63234],UP:[38,63232],RIGHT:[39,63235],DOWN:[40,63233],DELETE:[46],COMMA:[188],PERIOD:[190],'`':[192],'[':[219],']':[221]}});copy_properties(KeyEventController.prototype,{mapKey:function(a){if(typeof(a)=='number')return [48+a,96+a];var b=KeyEventController.keyCodeMap[a.toUpperCase()];if(b)return b;return [a.toUpperCase().charCodeAt(0)];},onkeyevent:function(i,c){c=$E(c);var d=null;var g=this.handlers[c.keyCode];var b,f,a;if(g)for(var h=0;h<g.length;h++){b=g[h].callback;f=g[h].filter;try{if(!f||f(c,i)){var node=null;if(window.Parent&&Parent.byTag&&c.getTarget)node=Parent.byTag(c.getTarget(),'a');user_action(node,'key',c);a=b(c,i);if(a===false)return Event.kill(c);}}catch(e){}}return true;},resetHandlers:function(){this.handlers={};}});
if(!this.JSON)this.JSON=function(){function f(n){return n<10?'0'+n:n;}Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,v;switch(typeof value){case 'string':return (new RegExp('[\x00-\x1f\\\\"]')).test(value)?'"'+value.replace(/[\x00-\x1f\\"]/g,function(a){var c=m[a];if(c)return c;c=a.charCodeAt();return '\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"':'"'+value+'"';case 'number':return isFinite(value)?String(value):'null';case 'boolean':return String(value);case 'null':return 'null';case 'object':if(DOM.isNode(value))return null;if(!value)return 'null';if(typeof value.toJSON==='function')return stringify(value.toJSON());a=[];if(typeof value.length==='number'&&!(propertyIsEnumerable(value,'length'))){l=value.length;for(i=0;i<l;i+=1)a.push(stringify(value[i],whitelist)||'null');return '['+a.join(',')+']';}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v)a.push(stringify(k)+':'+v);}}}else for(k in value)if(typeof k==='string'){v=stringify(value[k],whitelist);if(v)a.push(stringify(k)+':'+v);}return '{'+a.join(',')+'}';}}return {stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object')for(i in v)if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined)v[i]=n;}return filter(k,v);}if(text&&/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(:?[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}throw new SyntaxError('decodeJSON');}};}();function propertyIsEnumerable(a,b){if(a.propertyIsEnumerable)return a.propertyIsEnumerable(b);for(var c in a)if(c==b)return true;return false;}
function collect_data_attribs(e,i){var g={};var d={};var h=i.length;var f;for(f=0;f<h;++f){g[i[f]]={};d[i[f]]='data-'+i[f];}while(e){if(e.getAttribute)for(f=0;f<h;++f){var c=e.getAttribute(d[i[f]]);if(c){var b=JSON.parse(c);for(var a in b)if(g[i[f]][a]===undefined)g[i[f]][a]=b[a];}}e=e.parentNode;}return g;}function collect_data_attrib(a,b){return collect_data_attribs(a,[b])[b];}
add_properties('CSS',{supportsBorderRadius:function(){var c=['KhtmlBorderRadius','OBorderRadius','MozBorderRadius','WebkitBorderRadius','msBorderRadius','borderRadius'];var d=false,a=document.createElement('div');for(var b=c.length;b>=0;b--)if(d=a.style[c[b]]!==undefined)break;CSS.supportsBorderRadius=bagof(d);return d;}});
function show(){for(var b=0;b<arguments.length;b++){var a=ge(arguments[b]);if(a&&a.style)a.style.display='';}return false;}function hide(){for(var b=0;b<arguments.length;b++){var a=ge(arguments[b]);if(a&&a.style)a.style.display='none';}return false;}function shown(a){a=ge(a);return (a.style.display!='none'&&!(a.style.display==''&&a.offsetWidth==0));}function toggle(){for(var b=0;b<arguments.length;b++){var a=$(arguments[b]);a.style.display=CSS.getStyle(a,"display")=='block'?'none':'block';}return false;}function toggleDisplayNone(){for(var b=0;b<arguments.length;b++){var a=$(arguments[b]);if(shown(a)){hide(a);}else show(a);}return false;}
var ErrorDialog={showAsyncError:function(b){try{return ErrorDialog.show(b.getErrorSummary(),b.getErrorDescription());}catch(a){alert(b);}},show:function(c,b,a){return (new Dialog()).setTitle(c).setBody(b).setButtons([Dialog.OK]).setStackable(true).setClassName('errorDialog').setModal(true).setHandler(a||bagofholding).show();}};
add_properties('Form',{getInputs:function(a){a=a||document;return [].concat($A(DOM.scry(a,'input')),$A(DOM.scry(a,'select')),$A(DOM.scry(a,'textarea')),$A(DOM.scry(a,'button')));},getSelectValue:function(a){return a.options[a.selectedIndex].value;},setSelectValue:function(b,c){for(var a=0;a<b.options.length;++a)if(b.options[a].value==c){b.selectedIndex=a;break;}},getRadioValue:function(b){for(var a=0;a<b.length;a++)if(b[a].checked)return b[a].value;return null;},getElements:function(a){return $A(a.tagName=='FORM'?a.elements:Form.getInputs(a));},getAttribute:function(b,a){return (b.getAttributeNode(a)||{}).value||null;},setDisabled:function(b,a){Form.getElements(b).forEach(function(c){if(c.disabled!=undefined){var d=DataStore.get(c,'origDisabledState');if(a){if(d===undefined)DataStore.set(c,'origDisabledState',c.disabled);c.disabled=a;}else{if(d!==true)c.disabled=false;DataStore.remove(c,'origDisabledState');}}});},bootstrap:function(c,d){var e=(Form.getAttribute(c,'method')||'GET').toUpperCase();d=Parent.byTag(d,'button')||d;var f=DOMPath.findNodePath(c);var h=Parent.byClass(d,'stat_elem')||c;if(CSS.hasClass(h,'async_saving'))return;var b=Form.serialize(c,d);Form.setDisabled(c,true);var a=Form.getAttribute(c,'ajaxify')||Form.getAttribute(c,'action');var g=new AsyncRequest(a);g.setData(b).setNectarModuleDataSafe(c).setReadOnly(e=='GET').setMethod(e).setRelativeTo(c).setStatusElement(h).setHandler(function(i){if(i.isReplay())g.setRelativeTo(DOMPath.resolveNodePath(f));}).setFinallyHandler(Form.setDisabled.bind(null,c,false)).send();},serialize:function(b,c){var a={};Form.getElements(b).forEach(function(d){if(d.name&&!d.disabled&&d.type!='submit')if(!d.type||((d.type=='radio'||d.type=='checkbox')&&d.checked)||d.type=='text'||d.type=='password'||d.type=='hidden'||d.tagName=='TEXTAREA'){Form._serializeHelper(a,d.name,Input.getValue(d));}else if(d.tagName=='SELECT')for(var e=0,f=d.options.length;e<f;++e){var g=d.options[e];if(g.selected)Form._serializeHelper(a,d.name,g.value);}});if(c&&c.name&&'submit'==c.type&&DOM.contains(b,c)&&DOM.isNode(c,['input','button']))Form._serializeHelper(a,c.name,c.value);return Form._serializeFix(a);},_serializeHelper:function(a,d,e){var c=/([^\]]+)\[([^\]]*)\](.*)/.exec(d);if(c){a[c[1]]=a[c[1]]||{};if(c[2]==''){var b=0;while(a[c[1]][b]!=undefined)b++;}else b=c[2];if(c[3]==''){a[c[1]][b]=e;}else Form._serializeHelper(a[c[1]],b.concat(c[3]),e);}else a[d]=e;},_serializeFix:function(a){var e=[];for(var b in a){if(a instanceof Object)a[b]=Form._serializeFix(a[b]);e.push(b);}var d=0,c=true;e.sort().each(function(g){if(g!=d++)c=false;});if(c){var f={};e.each(function(g){f[g]=a[g];});return f;}else return a;},post:function(d,b,c){var a=document.createElement('form');a.action=d.toString();a.method='POST';a.style.display='none';if(c)a.target=c;if(ge('post_form_id'))b.post_form_id=$('post_form_id').value;b.fb_dtsg=Env.fb_dtsg;b.post_form_id_source='dynamic_post';b.next=htmlspecialchars(document.location.href);Form.createHiddenInputs(b,a);DOM.getRootElement().appendChild(a);a.submit();return false;},createHiddenInputs:function(g,a,d,f){d=d||{};var c;var h=URI.implodeQuery(g,'',false);var i=h.split('&');for(var b=0;b<i.length;b++)if(i[b]){var j=i[b].split('=');var e=j[0];var k=j[1];if(e===undefined||k===undefined)continue;k=URI.decodeComponent(k);if(d[e]&&f){d[e].value=k;}else{c=$N('input',{type:'hidden',name:e,value:k});d[e]=c;a.appendChild(c);}}return d;},getFirstElement:function(b){var f=['input[type="text"]','textarea','input[type="password"]','input[type="button"]','input[type="submit"]'];var e=[];for(var c=0;c<f.length&&e.length==0;c++)e=DOM.scry(b,f[c]);if(e.length>0){var d=e[0];try{if(elementY(d)>0&&elementX(d)>0)return d;}catch(a){}}return null;},focusFirst:function(b){var a=Form.getFirstElement(b);if(a){a.focus();return true;}return false;}});var DOMPath={findNodePath:function(c,e){e=e||[];if(c.id||!DOM.isNode(c.parentNode))return {id:c.id,path:e.reverse()};var d=c.parentNode;var b=d.childNodes;for(var a=0;a<b.length;++a)if(b[a]===c){e.push(a);return DOMPath.findNodePath(d,e);}return null;},resolveNodePath:function(a){var b=ge(a.id)||document.documentElement;return DOMPath._resolveNodePathChildren(a.path,b,0);},_resolveNodePathChildren:function(c,d,b){if(b===c.length)return d;var a=d.childNodes[c[b]];if(!a)return null;return DOMPath._resolveNodePathChildren(c,a,b+1);}};
function Dialog(a){this._show_loading=true;this._loading_text=null;this._loading_was_shown=false;this._auto_focus=true;this._fade_enabled=true;this._onload_handlers=[];this._top=125;this._uniqueID='dialog_'+Dialog._globalCount++;this._content=null;this._obj=null;this._popup=null;this._overlay=null;this._hidden_objects=[];if(a)this._setFromModel(a);}Metaprototype.makeFinal(Dialog);copy_properties(Dialog,{OK:{name:'ok',label:_tx("Okay")},CANCEL:{name:'cancel',label:_tx("Cancel"),className:'inputaux'},CLOSE:{name:'close',label:_tx("Close")},NEXT:{name:'next',label:_tx("Next")},SAVE:{name:'save',label:_tx("Save")},SUBMIT:{name:'submit',label:_tx("Submit")},CONFIRM:{name:'confirm',label:_tx("Confirm")},DELETE:{name:'delete',label:_tx("Delete")},_globalCount:0,_bottoms:[0],max_bottom:0,_updateMaxBottom:function(){Dialog.max_bottom=Math.max.apply(Math,Dialog._bottoms);}});copy_properties(Dialog,{OK_AND_CANCEL:[Dialog.OK,Dialog.CANCEL],_STANDARD_BUTTONS:[Dialog.OK,Dialog.CANCEL,Dialog.CLOSE,Dialog.SAVE,Dialog.SUBMIT,Dialog.CONFIRM,Dialog.DELETE],SHOULD_HIDE_OBJECTS:!ua.windows(),_useCSSBorders:CSS.supportsBorderRadius()||ua.ie()<=6,SIZE:{WIDE:555,STANDARD:445},_HALO_WIDTH:10,_BORDER_WIDTH:1,_PADDING_WIDTH:10,MODALITY:{DARK:'dark',WHITE:'white'},dialogStack:null,newButton:function(e,d,b,c){var a={name:e,label:d};if(b)a.className=b;if(c)a.handler=c;return a;},getCurrent:function(){var a=Dialog.dialogStack;if(!a||!a.length)return null;return a[a.length-1];},bootstrap:function(h,a,f,d,e,c){a=a||{};copy_properties(a,new URI(h).getQueryData());d=d||(f?'GET':'POST');var g=Parent.byClass(c,'stat_elem')||c;if(g&&CSS.hasClass(g,'async_saving'))return false;var b=new Dialog(e).setAsync(new AsyncRequest().setURI(h).setData(a).setReadOnly(!!f).setMethod(d).setStatusElement(g));b.show();return false;},_basicMutator:function(a){return function(b){this[a]=b;this._dirty();return this;};},_findButton:function(a,c){if(a)for(var b=0;b<a.length;++b)if(a[b].name==c)return a[b];return null;},_keyDownFilter:function(event,a){return a=='onkeydown'&&KeyEventController.filterEventModifiers(event,a);},_tearDown:function(){Dialog._hideAll();Dialog.dialogStack=null;},_hideAll:function(){if(Dialog.dialogStack!==null&&Dialog.dialogStack.length){var b=Dialog.dialogStack.clone();Dialog.dialogStack=null;for(var a=b.length-1;a>=0;a--)b[a].hide();}},_handleEscapeKey:function(event,a){Dialog._escape();},_escape:function(){var d=Dialog.getCurrent();if(!d)return true;var e=d._semi_modal;var b=d._buttons;if(!b&&!e)return true;if(e&&!b){d.hide();return false;}var a;var c=Dialog._findButton(b,'cancel');if(d._cancelHandler){d.cancel();return false;}else if(c){a=c;}else if(b.length==1){a=b[0];}else return true;d._handleButton(a);return false;},call_or_eval:function(obj,func,args){if(!func)return undefined;args=args||{};if(typeof(func)=='string'){var params=keys(args).join(', ');func=eval('({f: function('+params+') { '+func+'}})').f;}return func.apply(obj,values(args));}});copy_properties(Dialog.prototype,{show:function(a){this._showing=true;if(a){if(this._overlay)this._overlay.style.display='';if(this._fade_enabled)CSS.setStyle(this._obj,'opacity',1);this._obj.style.display='';}else this._dirty();return this;},showLoading:function(){this._loading_was_shown=true;this._renderDialog($N('div',{className:'dialog_loading'},this._loading_text||_tx("Loading...")));return this;},hide:function(a){if(!this._showing)return this;this._showing=false;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}if(this._fade_enabled&&(!Dialog.dialogStack||Dialog.dialogStack.length<=1)){this._fadeOut(a);}else this._hide(a);return this;},cancel:function(){if(!this._cancelHandler||this._cancelHandler()!==false)this.hide();},getRoot:function(){return this._obj;},getBody:function(){return DOM.scry(this._obj,'div.dialog_body')[0];},getButtonElement:function(a){if(typeof a=='string')a=Dialog._findButton(this._buttons,a);if(!a||!a.name)return null;var b=DOM.scry(this._popup,'input');var c=function(d){return d.name==a.name;};return b.filter(c)[0]||null;},getContentNode:function(){var a=DOM.scry(this._content,'div.dialog_content');a.length!=1;return a[0];},getFormData:function(){return Form.serialize(this.getContentNode());},setShowing:function(){this.show();return this;},setHiding:function(){this.hide();return this;},setTitle:Dialog._basicMutator('_title'),setBody:Dialog._basicMutator('_body'),setExtraData:Dialog._basicMutator('_extra_data'),setReturnData:Dialog._basicMutator('_return_data'),setShowLoading:Dialog._basicMutator('_show_loading'),setLoadingText:Dialog._basicMutator('_loading_text'),setFullBleed:Dialog._basicMutator('_full_bleed'),setImmediateRendering:function(a){this._immediate_rendering=a;return this;},setUserData:Dialog._basicMutator('_user_data'),getUserData:function(){return this._user_data;},setAutohide:function(a){if(a){if(this._showing){this._autohide_timeout=setTimeout(this.hide.shield(this),a);}else this._autohide=a;}else{this._autohide=null;if(this._autohide_timeout){clearTimeout(this._autohide_timeout);this._autohide_timeout=null;}}return this;},setSummary:Dialog._basicMutator('_summary'),setButtons:function(a){var c;if(!(a instanceof Array)){c=$A(arguments);}else c=a;for(var d=0;d<c.length;++d)if(typeof c[d]=='string'){var b=Dialog._findButton(Dialog._STANDARD_BUTTONS,c[d]);!b;c[d]=b;}this._buttons=c;this._updateButtons();return this;},setButtonsMessage:Dialog._basicMutator('_buttons_message'),setClickButtonOnEnter:function(b,a){this._clickButtonOnEnter=a;this._clickButtonOnEnterInputName=b;return this;},setStackable:function(b,a){this._is_stackable=b;this._shown_while_stacked=b&&a;return this;},setHandler:function(a){this._handler=a;return this;},setCancelHandler:function(a){this._cancelHandler=Dialog.call_or_eval.bind(null,this,a);return this;},setCloseHandler:function(a){this._close_handler=Dialog.call_or_eval.bind(null,this,a);return this;},clearHandler:function(){return this.setHandler(null);},setPostURI:function(b,a){if(a===undefined)a=true;if(a){this.setHandler(this._submitForm.bind(this,'POST',b));}else this.setHandler(function(){Form.post(b,this.getFormData());this.hide();}.bind(this));return this;},setGetURI:function(a){this.setHandler(this._submitForm.bind(this,'GET',a));return this;},setModal:function(a,b){if(a===undefined)a=true;this._showing&&this._modal&&!a;if(a&&b)switch(b){case Dialog.MODALITY.DARK:this._modal_class='dark';break;case Dialog.MODALITY.WHITE:this._modal_class='white';break;}this._modal=a;return this;},setSemiModal:function(a){if(a===undefined)a=true;if(a)this.setModal(true,Dialog.MODALITY.DARK);this._semi_modal=a;return this;},setWideDialog:Dialog._basicMutator('_wide_dialog'),setContentWidth:Dialog._basicMutator('_content_width'),setTitleLoading:function(b){if(b===undefined)b=true;var a=DOM.find(this._popup,'h2.dialog_title');if(a)CSS.conditionClass(a,'loading',b);return this;},setSecure:Dialog._basicMutator('_secure'),setClassName:Dialog._basicMutator('_class_name'),setFading:Dialog._basicMutator('_fade_enabled'),setFooter:Dialog._basicMutator('_footer'),setAutoFocus:Dialog._basicMutator('_auto_focus'),setTop:Dialog._basicMutator('_top'),onloadRegister:function(a){$A(a).forEach(function(b){if(typeof b=='string')b=new Function(b);this._onload_handlers.push(b.bind(this));}.bind(this));return this;},setAsyncURL:function(a){return this.setAsync(new AsyncRequest(a));},setAsync:function(a){var c=function(f){if(this._async_request!=a)return;this._async_request=null;var e=f.getPayload();if(typeof e=='string'){this.setBody(e);}else this._setFromModel(e);this._update(true);}.bind(this);var b=a.getData();b.__d=1;a.setData(b);var d=bind(this,'hide');a.setHandler(chain(a.getHandler(),c)).setErrorHandler(chain(d,a.getErrorHandler())).setTransportErrorHandler(chain(d,a.getTransportErrorHandler())).send();this._async_request=a;this._dirty();return this;},_dirty:function(){if(!this._is_dirty){this._is_dirty=true;if(this._immediate_rendering){this._update();}else bind(this,'_update',false).defer();}},_format:function(a){if(typeof a=='string'){a=HTML(a);}else a=HTML.replaceJSONWrapper(a);if(a instanceof HTML)a.setDeferred(true);return a;},_update:function(d){if(!this._is_dirty&&d!==true)return;this._is_dirty=false;if(!this._showing)return;if(this._autohide&&!this._async_request&&!this._autohide_timeout)this._autohide_timeout=setTimeout(bind(this,'hide'),this._autohide);if(!this._async_request||!this._show_loading){if(this._loading_was_shown===true){this._hide(true);this._loading_was_shown=false;}var b=[];if(this._summary)b.push($N('div',{className:'dialog_summary'},this._format(this._summary)));b.push($N('div',{className:'dialog_body'},this._format(this._body)));var a=this._getButtonContent();if(a.length)b.push($N('div',{className:'dialog_buttons clearfix'},a));if(this._footer)b.push($N('div',{className:'dialog_footer'},this._format(this._footer)));b=$N('div',{className:'dialog_content'},b);if(this._title){var g=$N('span',this._format(this._title));var h=$N('h2',{className:'dialog_title',id:'title_'+this._uniqueID},g);CSS.conditionClass(h,'secure',this._secure);b=[h,b];}else b=[b];this._renderDialog(b);CSS.conditionClass(this.getRoot(),'omitDialogFooter',!a.length);if(this._clickButtonOnEnterInputName&&this._clickButtonOnEnter&&ge(this._clickButtonOnEnterInputName))Event.listen(ge(this._clickButtonOnEnterInputName),'keypress',function(i){if(Event.getKeyCode(i)==KEYS.RETURN)this._handleButton(this._clickButtonOnEnter);return true;}.bind(this));for(var f=0;f<this._onload_handlers.length;++f)try{this._onload_handlers[f]();}catch(e){}this._onload_handlers=[];}else this.showLoading();var c=2*Dialog._BORDER_WIDTH;if(Dialog._useCSSBorders)c+=2*Dialog._HALO_WIDTH;if(this._content_width){c+=this._content_width;if(!this._full_bleed)c+=2*Dialog._PADDING_WIDTH;}else if(this._wide_dialog){c+=Dialog.SIZE.WIDE;}else c+=Dialog.SIZE.STANDARD;this._popup.style.width=c+'px';},_updateButtons:function(){if(!this._showing)return;var b=this._getButtonContent();var c=null;if(!this.getRoot())this._buildDialog();CSS.conditionClass(this.getRoot(),'omitDialogFooter',!b.length);if(b.length)c=$N('div',{className:'dialog_buttons clearfix'},b);var d=DOM.scry(this._content,'div.dialog_buttons')[0]||null;if(!d){if(!c)return;var a=this.getBody();if(a)DOM.insertAfter(a,c);}else if(c){DOM.replace(d,c);}else DOM.remove(d);},_getButtonContent:function(){var b=[];if((this._buttons&&this._buttons.length>0)||this._buttons_message){if(this._buttons_message)b.push($N('div',{className:'dialog_buttons_msg'},this._format(this._buttons_message)));if(this._buttons)for(var d=0;d<this._buttons.length;d++){var a=this._buttons[d];var c=$N('label',{className:'uiButton uiButtonLarge uiButtonConfirm'},$N('input',{type:'button',name:a.name||'',value:a.label}));if(a.className){a.className.split(/\s+/).each(function(e){CSS.addClass(c,e);});if(CSS.hasClass(c,'inputaux')){CSS.removeClass(c,'inputaux');CSS.removeClass(c,'uiButtonConfirm');}}Event.listen(c.firstChild,'click',this._handleButton.bind(this,a.name));b.push(c);}}return b;},_renderDialog:function(b){if(Dialog.dialogStack===null){KeyEventController.registerKey('ESCAPE',Dialog._handleEscapeKey,Dialog._keyDownFilter);onleaveRegister(Dialog._tearDown);Arbiter.subscribe('page_transition',Dialog._tearDown);}if(!this._obj)this._buildDialog();if(this._class_name)CSS.addClass(this._obj,this._class_name);CSS.conditionClass(this._obj,'full_bleed',this._full_bleed);if(typeof b=='string')b=HTML(b).setDeferred(this._immediate_rendering!==true);DOM.setContent(this._content,b);this._showDialog();if(this._auto_focus)Form.focusFirst.bind(this,this._content).defer();var a=Vector2.getElementDimensions(this._content).y+Vector2.getElementPosition(this._content).y;Dialog._bottoms.push(a);this._bottom=a;Dialog._updateMaxBottom();return this;},_buildDialog:function(){this._obj=$N('div',{className:'generic_dialog',tabIndex:'0'});this._obj.setAttribute('role','alertdialog');this._obj.setAttribute('aria-labelledby','title_'+this._uniqueID);this._obj.style.display='none';DOM.getRootElement().appendChild(this._obj);if(!this._popup)this._popup=$N('div',{className:'generic_dialog_popup'});this._popup.style.left=this._popup.style.top='';this._obj.appendChild(this._popup);this._buildDialogContent();},_showDialog:function(){if(this._modal)if(this._overlay){this._overlay.style.display='';}else this._buildOverlay();if(this._obj&&this._obj.style.display){this._obj.style.visibility='hidden';this._obj.style.display='';this._resetDialog();this._obj.style.visibility='';this._obj.dialog=this;}else this._resetDialog();clearInterval(this.active_hiding);this.active_hiding=setInterval(this._activeResize.bind(this),500);if(!Dialog.dialogStack)Dialog.dialogStack=[];var c=Dialog.dialogStack;if(c.length){var a=c[c.length-1];if(a!=this&&(!a._is_stackable||(a._show_loading&&a._loading_was_shown)))a._hide();for(var b=c.length-1;b>=0;b--)if(c[b]==this){c.splice(b,1);}else if(!c[b]._shown_while_stacked)c[b]._hide(true);}c.push(this);return this;},_activeResize:function(){if(this.last_offset_height!=this._content.offsetHeight)this.last_offset_height=this._content.offsetHeight;},_buildDialogContent:function(){CSS.addClass(this._obj,'pop_dialog');if(intl_locale_is_rtl())CSS.addClass(this._obj,'pop_dialog_rtl');var a;if(Dialog._useCSSBorders){a='<div class="pop_container_advanced">'+'<div class="pop_content" id="pop_content"></div>'+'</div>';}else a='<div class="pop_container">'+'<div class="pop_verticalslab"></div>'+'<div class="pop_horizontalslab"></div>'+'<div class="pop_topleft"></div>'+'<div class="pop_topright"></div>'+'<div class="pop_bottomright"></div>'+'<div class="pop_bottomleft"></div>'+'<div class="pop_content pop_content_old" id="pop_content"></div>'+'</div>';DOM.setContent(this._popup,HTML(a));this._frame=DOM.find(this._popup,'div.pop_content');this._content=this._frame;},_buildOverlay:function(){this._overlay=$N('div',{id:'generic_dialog_overlay'});if(this._modal_class)CSS.addClass(this._overlay,this._modal_class);if(this._semi_modal){var a=function(b){if(b.getTarget()==this._obj||b.getTarget()==this._overlay)this.hide();}.bind(this);Event.listen(this._obj,'click',a);Event.listen(this._overlay,'click',a);}if(ua.ie()<7)this._overlay.style.height=Vector2.getDocumentDimensions().y+'px';onloadRegister(function(){document.body.appendChild(this._overlay);}.bind(this));},_resetDialog:function(){if(!this._popup)return;this._resetDialogObj();},_resetDialogObj:function(){var c=DOM.find(this._popup,'div.pop_content');var b=Vector2.getScrollPosition().y;var f=Vector2.getViewportDimensions().y;var d=Vector2.getElementDimensions(c).y;var e=b+this._top+'px';if(this._top+d>f){var a=Math.max(f-d,0);e=((a/2)+b)+'px';}this._popup.style.top=e;},_fadeOut:function(b){if(!this._popup)return;try{animation(this._obj).duration(0).checkpoint().to('opacity',0).hide().duration(250).ondone(this._hide.bind(this,b)).go();}catch(a){this._hide(b);}},_hide:function(d){if(this._obj)this._obj.style.display='none';if(this._overlay)if(d){this._overlay.style.display='none';}else{DOM.remove(this._overlay);this._overlay=null;}if(this.timeout){clearTimeout(this.timeout);this.timeout=null;}if(this._hidden_objects.length){for(var b=0,c=this._hidden_objects.length;b<c;b++)this._hidden_objects[b].style.visibility='';this._hidden_objects=[];}clearInterval(this.active_hiding);if(this._bottom){var a=Dialog._bottoms;a.splice(a.indexOf(this._bottom),1);Dialog._updateMaxBottom();}if(d)return;this.destroy();},destroy:function(){if(Dialog.dialogStack&&Dialog.dialogStack.length){var b=Dialog.dialogStack;for(var a=b.length-1;a>=0;a--)if(b[a]==this)b.splice(a,1);if(b.length)b[b.length-1]._showDialog();}if(this._obj){DOM.remove(this._obj);this._obj=null;}if(this._close_handler)this._close_handler({return_data:this._return_data});},_handleButton:function(a){if(typeof a=='string')a=Dialog._findButton(this._buttons,a);if(!a)return;var b=Dialog.call_or_eval(a,a.handler);if(b===false)return;if(a.name=='cancel'){this.cancel();}else if(Dialog.call_or_eval(this,this._handler,{button:a})!==false)this.hide();},_submitForm:function(d,e,b){var c=this.getFormData();if(b)c[b.name]=b.label;if(this._extra_data)copy_properties(c,this._extra_data);var a=new AsyncRequest().setURI(e).setData(c).setMethod(d).setReadOnly(d=='GET');this.setAsync(a);return false;},_setFromModel:function(c){var a={};copy_properties(a,c);if(a.immediateRendering){this.setImmediateRendering(a.immediateRendering);delete a.immediateRendering;}for(var d in a){if(d=='onloadRegister'){this.onloadRegister(a[d]);continue;}var b=this['set'+d.substr(0,1).toUpperCase()+d.substr(1)];if(!(!b))b.apply(this,$A(a[d]));}},_updateBottom:function(){var a=Vector2.getElementDimensions(this._content).y+Vector2.getElementPosition(this._content).y;Dialog._bottoms[Dialog._bottoms.length-1]=a;Dialog._updateMaxBottom();}});
function AsyncRequest(uri){var dispatchResponse=bind(this,function(asyncResponse){try{this.clearStatusIndicator();this._measureSaved&&this._measureSaved();if(this._isPrefetch){this._isPrefetch=false;return;}if(!this.isRelevant()){invokeErrorHandler(1010);return;}if(this.initialHandler(asyncResponse)!==false){clearTimeout(this.timer);asyncResponse.jscc&&invoke_callbacks([asyncResponse.jscc]);if(this.handler)try{var suppress_onload=this.handler(asyncResponse);}catch(exception){asyncResponse.is_last&&this.finallyHandler(asyncResponse);throw exception;}asyncResponse.is_last&&this.finallyHandler(asyncResponse);if(suppress_onload!==AsyncRequest.suppressOnloadToken){var onload=asyncResponse.onload;if(onload)for(var ii=0;ii<onload.length;ii++)try{(new Function(onload[ii])).apply(this);}catch(exception){}if(this.lid&&!asyncResponse.isReplay())Arbiter.inform('tti_ajax',{s:this.lid,d:[this._sendTimeStamp||0,(this._sendTimeStamp&&this._responseTime)?(this._responseTime-this._sendTimeStamp):0]},Arbiter.BEHAVIOR_EVENT);var onafterload=asyncResponse.onafterload;if(onafterload)for(var ii=0;ii<onafterload.length;ii++)try{(new Function(onafterload[ii])).apply(this);}catch(exception){}}var invalidate_cache=asyncResponse.invalidate_cache;if(!this.getOption('suppressCacheInvalidation')&&invalidate_cache&&invalidate_cache.length)Arbiter.inform(Arbiter.PAGECACHE_INVALIDATE,invalidate_cache);}if(asyncResponse.cacheObservation&&typeof(TabConsoleCacheobserver)!='undefined'&&TabConsoleCacheobserver.instance)TabConsoleCacheobserver.getInstance().addAsyncObservation(asyncResponse.cacheObservation);}catch(exception){}});var replayResponses=bind(this,function(){if(is_empty(this._asyncResponses))return;this.setNewSerial();for(var ii=0;ii<this._asyncResponses.length;++ii){var r=this._asyncResponses[ii];invokeResponseHandler(r,true);}});var dispatchErrorResponse=bind(this,function(asyncResponse,isTransport){try{this.clearStatusIndicator();var async_error=asyncResponse.getError();if(this._sendTimeStamp){var _duration=(+new Date())-this._sendTimeStamp;var xfb_ip=this._xFbServer||'-';asyncResponse.logError('async_error',_duration+':'+xfb_ip);}else asyncResponse.logError('async_error');if((!this.isRelevant())||async_error===1010)return;if(async_error==1357008||async_error==1357007||async_error==1442002||async_error==1357001){var is_confirmation=false;if(async_error==1357008||async_error==1357007)is_confirmation=true;var payload=asyncResponse.getPayload();this._displayServerDialog(payload.__dialog,is_confirmation);}else if(this.initialHandler(asyncResponse)!==false){clearTimeout(this.timer);try{if(isTransport){this.transportErrorHandler(asyncResponse);}else this.errorHandler(asyncResponse);}catch(exception){this.finallyHandler(asyncResponse);throw exception;}this.finallyHandler(asyncResponse);}}catch(exception){}});var _interpretTransportResponse=bind(this,function(){if(this.getOption('suppressEvaluation')){var r=new AsyncResponse(this,this.transport);return {asyncResponse:r};}var _sendError=function(p,error_code,str){if(!window.send_error_signal)return;send_error_signal('async_xport_resp',error_code+':'+(this._xFbServer||'-')+':'+p.getURI()+':'+str.length+':'+str.substr(0,1600));};var shield="for (;;);";var shieldlen=shield.length;var text=this.transport.responseText;if(text.length<=shieldlen){_sendError(this,'1008_empty',text);return {transportError:'Response too short on async to '+this.getURI()};}var offset=0;while(text.charAt(offset)==" "||text.charAt(offset)=="\n")offset++;offset&&text.substring(offset,offset+shieldlen)==shield;var safeResponse=text.substring(offset+shieldlen);try{var response=eval('('+safeResponse+')');}catch(exception){_sendError(this,'1008_excep',text);return {transportError:'eval() failed on async to '+this.getURI()};}return interpretResponse(response);});var interpretResponse=bind(this,function(response){if(response.redirect)return {redirect:response.redirect};var r=new AsyncResponse(this);if(typeof(response.payload)=='undefined'||typeof(response.error)=='undefined'||typeof(response.errorDescription)=='undefined'||typeof(response.errorSummary)=='undefined'||typeof(response.errorIsWarning)=='undefined'){r.payload=response;}else{copy_properties(r,response);if(response.tplts)if(window.DynaTemplate)DynaTemplate.registerTemplates(response.tplts);}return {asyncResponse:r};});var invokeResponseHandler=bind(this,function(interp,is_replay){if(typeof(interp.redirect)!='undefined'){(function(){this.setURI(interp.redirect).send();}).bind(this).defer();return;}if(this.handler||this.errorHandler||this.transportErrorHandler)if(typeof(interp.asyncResponse)!='undefined'){var r=interp.asyncResponse;r.setReplay(!!is_replay);if(!this.isRelevant()){invokeErrorHandler(1010);return;}if(r.inlinejs)eval_global(r.inlinejs);if(r.lid){this._responseTime=(+new Date());if(window.CavalryLogger)this.cavalry=CavalryLogger.getInstance(r.lid);this.lid=r.lid;}if(r.getError()&&!r.getErrorIsWarning()){var fn=dispatchErrorResponse;}else{var fn=dispatchResponse;if(this._replayable&&!is_replay&&!r.dontReplay){this._asyncResponses=this._asyncResponses||[];this._asyncResponses.push(interp);}}Bootloader.setResourceMap(r.resource_map);if(r.bootloadable)Bootloader.enableBootload(r.bootloadable);fn=fn.shield(null,r);fn=fn.defer.bind(fn);var is_transitional=false;if(this.preBootloadHandler)is_transitional=this.preBootloadHandler(r);r.css=r.css||[];r.js=r.js||[];Bootloader.loadResources(r.css.concat(r.js),fn,is_transitional,this.getURI());}else if(typeof(interp.transportError)!='undefined'){if(this._xFbServer){invokeErrorHandler(1008);}else invokeErrorHandler(1012);}else invokeErrorHandler(1007);});var invokeErrorHandler=bind(this,function(explicitError){try{if(!window.loaded)return;}catch(ex){return;}var r=new AsyncResponse(this);var err;try{err=explicitError||this.transport.status||1004;}catch(ex){err=1005;}if(this._requestAborted)err=1011;try{if(this.responseText=='')err=1002;}catch(ignore){}if(this.transportErrorHandler){var desc,summary;var silent=true;if(false===navigator.onLine){summary=_tx("No Network Connection");desc=_tx("Your browser appears to be offline. Please check your internet connection and try again.");err=1006;silent=false;}else if(err>=300&&err<=399){summary=_tx("Redirection");desc=_tx("Your access to Facebook was redirected or blocked by a third party at this time, please contact your ISP or reload. ");redir_url=this.transport.getResponseHeader("Location");if(redir_url)goURI(redir_url,true);silent=true;}else{summary=_tx("Oops");desc=_tx("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");}!this.getOption('suppressErrorAlerts');copy_properties(r,{error:err,errorSummary:summary,errorDescription:desc,silentError:silent});dispatchErrorResponse(r,true);}});var handleResponse=function(response){var asyncResponse=this.interpretResponse(response);this.invokeResponseHandler(asyncResponse);};var onStateChange=function(){try{if(this.transport.readyState==4){try{if(typeof(this.transport.getResponseHeader)!='undefined'&&this.transport.getResponseHeader('X-FB-Server'))this._xFbServer=this.transport.getResponseHeader('X-FB-Server');}catch(ex){}if(this.transport.status>=200&&this.transport.status<300){invokeResponseHandler(_interpretTransportResponse());}else if(ua.safari()&&(typeof(this.transport.status)=='undefined')){invokeErrorHandler(1002);}else if(window.send_error_signal&&window.Env&&window.Env.retry_ajax_on_network_error&&this.transport.status in {0:1,12029:1,12030:1,12031:1,12152:1}&&this.remainingRetries>0){--this.remainingRetries;delete this.transport;this.send(true);return;}else invokeErrorHandler();if(this.getOption('asynchronous')!==false)delete this.transport;}}catch(exception){try{if(!window.loaded)return;}catch(ex){return;}delete this.transport;if(this.remainingRetries>0){--this.remainingRetries;this.send(true);}else{!this.getOption('suppressErrorAlerts');if(window.send_error_signal)send_error_signal('async_xport_resp','1007:'+(this._xFbServer||'-')+':'+this.getURI()+':'+exception.message);invokeErrorHandler(1007);}}};var onJSONPResponse=function(data,more_chunked_response){var is_first=(this.is_first===undefined);this.is_first=is_first;if(this.transportIframe&&!more_chunked_response)(function(x){document.body.removeChild(x);}).bind(null,this.transportIframe).defer();if(ua.ie()>=9&&window.JSON)data=window.JSON.parse(window.JSON.stringify(data));var r=this.interpretResponse(data);r.asyncResponse.is_first=is_first;r.asyncResponse.is_last=!more_chunked_response;this.invokeResponseHandler(r);return more_chunked_response;};copy_properties(this,{onstatechange:onStateChange,onjsonpresponse:onJSONPResponse,replayResponses:replayResponses,invokeResponseHandler:invokeResponseHandler,interpretResponse:interpretResponse,handleResponse:handleResponse,transport:null,method:'POST',uri:'',timeout:null,timer:null,initialHandler:bagofholding,handler:null,errorHandler:null,transportErrorHandler:null,timeoutHandler:null,finallyHandler:bagofholding,serverDialogCancelHandler:bagofholding,relativeTo:null,statusElement:null,statusClass:'',data:{},context:{},readOnly:false,writeRequiredParams:['post_form_id'],remainingRetries:0,option:{asynchronous:true,suppressCacheInvalidation:false,suppressErrorHandlerWarning:false,suppressEvaluation:false,suppressErrorAlerts:false,retries:0,jsonp:false,bundle:false,useIframeTransport:false,tfbEndpoint:true},_replayable:undefined,_replayKey:'',_isPrefetch:false});this.errorHandler=AsyncResponse.defaultErrorHandler;this.transportErrorHandler=bind(this,'errorHandler');if(uri!=undefined)this.setURI(uri);return this;}Arbiter.subscribe("page_transition",function(b,a){AsyncRequest._id_threshold=a.id;});copy_properties(AsyncRequest,{pingURI:function(c,a,b){a=a||{};return new AsyncRequest().setURI(c).setData(a).setOption('asynchronous',!b).setOption('suppressErrorHandlerWarning',true).setErrorHandler(bagofholding).setTransportErrorHandler(bagofholding).send();},receiveJSONPResponse:function(b,a,c){if(this._JSONPReceivers[b])if(!this._JSONPReceivers[b](a,c))delete this._JSONPReceivers[b];},_hasBundledRequest:function(){return AsyncRequest._allBundledRequests.length>0;},stashBundledRequest:function(){var a=AsyncRequest._allBundledRequests;AsyncRequest._allBundledRequests=[];return a;},setBundledRequestProperties:function(b){var c=null;if(b.stashedRequests)AsyncRequest._allBundledRequests=AsyncRequest._allBundledRequests.concat(b.stashedRequests);if(!AsyncRequest._hasBundledRequest()){var a=b.callback;a&&a();}else{copy_properties(AsyncRequest._bundledRequestProperties,b);if(b.start_immediately)c=AsyncRequest._sendBundledRequests();}return c;},_bundleRequest:function(b){if(b.getOption('jsonp')||b.getOption('useIframeTransport')){b.setOption('bundle',false);return false;}else if(!b.uri.isFacebookURI()){b.setOption('bundle',false);return false;}else if(!b.getOption('asynchronous')){b.setOption('bundle',false);return false;}var a=b.uri.getPath();if(!AsyncRequest._bundleTimer)AsyncRequest._bundleTimer=setTimeout(function(){AsyncRequest._sendBundledRequests();},0);AsyncRequest._allBundledRequests.push([a,b]);return true;},_sendBundledRequests:function(){clearTimeout(AsyncRequest._bundleTimer);AsyncRequest._bundleTimer=null;var a=AsyncRequest._allBundledRequests;AsyncRequest._allBundledRequests=[];var e={};copy_properties(e,AsyncRequest._bundledRequestProperties);AsyncRequest._bundledRequestProperties={};if(is_empty(e)&&a.length==1){var g=a[0][1];g.setOption('bundle',false).send();return g;}var d=function(){e.callback&&e.callback();};if(a.length===0){d();return null;}var b=[];for(var c=0;c<a.length;c++)b.push([a[c][0],URI.implodeQuery(a[c][1].data)]);var f={data:b};if(e.extra_data)copy_properties(f,e.extra_data);var g=new AsyncRequest();g.setURI('/ajax/proxy.php').setData(f).setMethod('POST').setInitialHandler(e.onInitialResponse||bagof(true)).setAllowCrossPageTransition(true).setHandler(function(l){var k=l.getPayload();var n=k.responses;if(n.length!=a.length){return;}else for(var i=0;i<a.length;i++){var j=a[i][0];var m=a[i][1];m.id=this.id;if(n[i][0]!=j){m.invokeResponseHandler({transportError:'Wrong response order in bundled request to '+j});continue;}var h=m.interpretResponse(n[i][1]);m.invokeResponseHandler(h);}}).setTransportErrorHandler(function(m){var k=[];var i={transportError:m.errorDescription};for(var h=0;h<a.length;h++){var j=a[h][0];var l=a[h][1];k.push(j);l.id=this.id;l.invokeResponseHandler(i);}}).setFinallyHandler(function(h){d();}).send();return g;},bootstrap:function(c,b,d){var e='GET';var f=true;var a={};if(d||(b&&b.rel=='async-post')){e='POST';f=false;if(c){c=URI(c);a=c.getQueryData();c.setQueryData({});}}var g=Parent.byClass(b,'stat_elem')||b;if(g&&CSS.hasClass(g,'async_saving'))return false;new AsyncRequest(c).setReadOnly(f).setMethod(e).setData(a).setNectarModuleDataSafe(b).setStatusElement(g).setRelativeTo(b).send();return false;},post:function(b,a){new AsyncRequest(b).setReadOnly(false).setMethod('POST').setData(a).send();return false;},clearCache:function(){AsyncRequest._reqsCache={};},getLastId:function(){return AsyncRequest._last_id;},_JSONPReceivers:{},_allBundledRequests:[],_bundledRequestProperties:{},_bundleTimer:null,suppressOnloadToken:{},REPLAYABLE_AJAX:'ajax/replayable',_last_id:2,_id_threshold:2,_reqsCache:{}});copy_properties(AsyncRequest.prototype,{setMethod:function(a){this.method=a.toString().toUpperCase();return this;},getMethod:function(){return this.method;},setData:function(a){this.data=a;return this;},getData:function(){return this.data;},setContextData:function(b,c,a){a=a===undefined?true:a;if(a)this.context['_log_'+b]=c;return this;},setURI:function(a){var b=URI(a);if(this.getOption('useIframeTransport')&&!b.isFacebookURI())return this;if(!this.getOption('jsonp')&&!this.getOption('useIframeTransport')&&!b.isSameOrigin())return this;if(!a||b.toString()===''){if(window.send_error_signal&&window.get_error_stack){send_error_signal('async_error','1013:-:0:-:'+window.location.href);send_error_signal('async_xport_stack','1013:'+window.location.href+'::'+get_error_stack());}return this;}this.uri=b;return this;},getURI:function(){return this.uri.toString();},setInitialHandler:function(a){this.initialHandler=a;return this;},setHandler:function(a){if(!(typeof(a)!='function'))this.handler=a;return this;},getHandler:function(){return this.handler;},setErrorHandler:function(a){if(!(typeof(a)!='function'))this.errorHandler=a;return this;},setTransportErrorHandler:function(a){this.transportErrorHandler=a;return this;},getErrorHandler:function(){return this.errorHandler;},getTransportErrorHandler:function(){return this.transportErrorHandler;},setTimeoutHandler:function(b,a){if(!(typeof(a)!='function')){this.timeout=b;this.timeoutHandler=a;}return this;},resetTimeout:function(a){if(!(this.timeoutHandler===null))if(a===null){this.timeout=null;clearTimeout(this.timer);this.timer=null;}else{this.timeout=a;clearTimeout(this.timer);this.timer=this._handleTimeout.bind(this).defer(this.timeout);}return this;},_handleTimeout:function(){this.abandon();this.timeoutHandler(this);},setNewSerial:function(){this.id=++AsyncRequest._last_id;return this;},setFinallyHandler:function(a){this.finallyHandler=a;return this;},setServerDialogCancelHandler:function(a){this.serverDialogCancelHandler=a;return this;},setPreBootloadHandler:function(a){this.preBootloadHandler=a;return this;},setReadOnly:function(a){if(!(typeof(a)!='boolean'))this.readOnly=a;return this;},setFBMLForm:function(){this.writeRequiredParams=["fb_sig"];return this;},getReadOnly:function(){return this.readOnly;},setRelativeTo:function(a){this.relativeTo=a;return this;},getRelativeTo:function(){return this.relativeTo;},setStatusClass:function(a){this.statusClass=a;return this;},setStatusElement:function(a){this.statusElement=a;return this;},getStatusElement:function(){return ge(this.statusElement);},isRelevant:function(){if(this._allowCrossPageTransition)return true;if(!this.id)return true;return this.id>AsyncRequest._id_threshold;},clearStatusIndicator:function(){var a=this.getStatusElement();if(a){CSS.removeClass(a,'async_saving');CSS.removeClass(a,this.statusClass);}},addStatusIndicator:function(){var a=this.getStatusElement();if(a){CSS.addClass(a,'async_saving');CSS.addClass(a,this.statusClass);}},specifiesWriteRequiredParams:function(){return this.writeRequiredParams.every(function(a){this.data[a]=this.data[a]||Env[a]||(ge(a)||{}).value;if(this.data[a]!==undefined)return true;return false;},this);},setReplayable:function(b,a){this._replayable=b;this._replayKey=a||'';return this;},setOption:function(a,b){if(typeof(this.option[a])!='undefined')this.option[a]=b;return this;},getOption:function(a){typeof(this.option[a])=='undefined';return this.option[a];},abort:function(){if(this.transport){var a=this.getTransportErrorHandler();this.setOption('suppressErrorAlerts',true);this.setTransportErrorHandler(bagofholding);this._requestAborted=1;this.transport.abort();this.setTransportErrorHandler(a);}},abandon:function(){clearTimeout(this.timer);this.setOption('suppressErrorAlerts',true).setHandler(bagofholding).setErrorHandler(bagofholding).setTransportErrorHandler(bagofholding);if(this.transport){this._requestAborted=1;this.transport.abort();}},setNectarActionData:function(a){if(this.data.nctr===undefined)this.data.nctr={};this.data.nctr._ia=1;if(a){if(this.data.nctr._as===undefined)this.data.nctr._as={};copy_properties(this.data.nctr._as,a);}return this;},setNectarData:function(a){if(a){if(this.data.nctr===undefined)this.data.nctr={};copy_properties(this.data.nctr,a);}return this;},setNectarModuleDataSafe:function(a){if(this.setNectarModuleData)this.setNectarModuleData(a);return this;},setNectarImpressionIdSafe:function(){if(this.setNectarImpressionId)this.setNectarImpressionId();return this;},setPrefetch:function(a){this._isPrefetch=a;this.setAllowCrossPageTransition(true);return this;},setAllowCrossPageTransition:function(a){this._allowCrossPageTransition=!!a;return this;},send:function(c){if(this._checkCache&&this._checkCache())return true;c=c||false;if(!this.uri)return false;!this.errorHandler&&!this.getOption('suppressErrorHandlerWarning');if(this.getOption('jsonp')&&this.method!='GET')this.setMethod('GET');if(this.getOption('useIframeTransport')&&this.method!='GET')this.setMethod('GET');this.timeoutHandler!==null&&(this.getOption('jsonp')||this.getOption('useIframeTransport'));if(!this.getReadOnly()){if(!this.specifiesWriteRequiredParams())return false;if(this.method!='POST')return false;}if(this.method=='POST'&&this.getOption('tfbEndpoint')){this.data.fb_dtsg=Env.fb_dtsg;this.data.lsd=getCookie('lsd');}this._replayable=(!this.getReadOnly()&&this._replayable!==false)||this._replayable;if(this._replayable)Arbiter.inform(AsyncRequest.REPLAYABLE_AJAX,this);if(!is_empty(this.context)&&this.getOption('tfbEndpoint')){copy_properties(this.data,this.context);this.data.ajax_log=1;}if(!this.getReadOnly()&&this.getOption('tfbEndpoint')&&this.method=='POST'&&this.data.post_form_id_source===undefined)this.data.post_form_id_source='AsyncRequest';if(this.getOption('bundle')&&AsyncRequest._bundleRequest(this))return true;this.setNewSerial();if(this.getOption('tfbEndpoint'))this.uri.addQueryData({__a:1});this.finallyHandler=async_callback(this.finallyHandler,'final');var h,d;if(this.method=='GET'){h=this.uri.addQueryData(this.data).toString();d='';}else{h=this.uri.toString();d=URI.implodeQuery(this.data);}if(this.getOption('jsonp')||this.getOption('useIframeTransport')){h=this.uri.addQueryData({__a:this.id}).toString();AsyncRequest._JSONPReceivers[this.id]=async_callback(bind(this,'onjsonpresponse'),'json');if(this.getOption('jsonp')){(function(){document.body.appendChild($N('script',{src:h,type:"text/javascript"}));}).bind(this).defer();}else{var e={position:'absolute',top:'-1000px',left:'-1000px',width:'80px',height:'80px'};this.transportIframe=$N('iframe',{src:h,style:e});document.body.appendChild(this.transportIframe);}return true;}if(this.transport)return false;var g=null;try{g=new XMLHttpRequest();}catch(b){}if(!g)try{g=new ActiveXObject("Msxml2.XMLHTTP");}catch(b){}if(!g)try{g=new ActiveXObject("Microsoft.XMLHTTP");}catch(b){}if(!g)return false;g.onreadystatechange=async_callback(bind(this,'onstatechange'),'xhr');if(!c)this.remainingRetries=this.getOption('retries');if(window.send_error_signal||window.ArbiterMonitor)this._sendTimeStamp=this._sendTimeStamp||(+new Date());this.transport=g;try{this.transport.open(this.method,h,this.getOption('asynchronous'));}catch(a){return false;}var f=env_get('svn_rev');if(f)this.transport.setRequestHeader('X-SVN-Rev',String(f));if(this.method=='POST')this.transport.setRequestHeader('Content-Type','application/x-www-form-urlencoded');this.addStatusIndicator();this.transport.send(d);if(this.timeout!==null)this.resetTimeout(this.timeout);return true;},_displayServerDialog:function(c,b){var a=new Dialog(c);if(b)a.setHandler(this._displayConfirmationHandler.bind(this,a));a.setCancelHandler(function(){this.serverDialogCancelHandler.apply(this,arguments);this.finallyHandler.apply(this,arguments);}.bind(this)).setCloseHandler(this.finallyHandler.bind(this)).show();},_displayConfirmationHandler:function(a){this.data.confirmed=1;copy_properties(this.data,a.getFormData());this.send();}});function AsyncResponse(b,a){copy_properties(this,{error:0,errorSummary:null,errorDescription:null,onload:null,replay:false,payload:a||null,request:b||null,silentError:false,is_last:true});return this;}copy_properties(AsyncResponse,{defaultErrorHandler:function(b){try{if(!b.silentError){AsyncResponse.verboseErrorHandler(b);}else b.logErrorByGroup('silent',10);}catch(a){alert(b);}},verboseErrorHandler:function(b){try{var summary=b.getErrorSummary();var desc=b.getErrorDescription();b.logErrorByGroup('popup',10);if(b.silentError&&desc=='')desc=_tx("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");ErrorDialog.show(summary,desc);}catch(a){alert(b);}}});copy_properties(AsyncResponse.prototype,{getRequest:function(){return this.request;},getPayload:function(){return this.payload;},getError:function(){return this.error;},getErrorSummary:function(){return this.errorSummary;},setErrorSummary:function(a){a=(a===undefined?null:a);this.errorSummary=a;return this;},getErrorDescription:function(){return this.errorDescription;},getErrorIsWarning:function(){return this.errorIsWarning;},setReplay:function(a){a=(a===undefined?true:a);this.replay=!!a;return this;},isReplay:function(){return this.replay;},logError:function(a,c){if(window.send_error_signal){c=(c===undefined?'':(':'+c));var d=this.request.getURI();var b=this.error+':'+(env_get('vip')||'-')+c+':'+d;if(!d||d.indexOf('scribe_endpoint.php')!=-1)a='async_error_double';send_error_signal(a,b);}},logErrorByGroup:function(b,a){if(Math.floor(Math.random()*a)==0)if(this.error==1357010||this.error<15000){this.logError('async_error_oops_'+b);}else this.logError('async_error_logic_'+b);}});
var DOMScroll={getScrollState:function(){var d=Vector2.getViewportDimensions();var a=Vector2.getDocumentDimensions();var b=(a.x>d.x);var c=(a.y>d.y);b+=0;c+=0;return new Vector2(b,c);},_scrollbarSize:null,_initScrollbarSize:function(){var a=$N('p');a.style.width='100%';a.style.height='200px';var b=$N('div');b.style.position='absolute';b.style.top='0px';b.style.left='0px';b.style.visibility='hidden';b.style.width='200px';b.style.height='150px';b.style.overflow='hidden';b.appendChild(a);document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow='scroll';var d=a.offsetWidth;if(c==d)d=b.clientWidth;document.body.removeChild(b);DOMScroll._scrollbarSize=c-d;if(DOMScroll._scrollbarSize<5)DOMScroll._scrollbarSize=15;},getScrollbarSize:function(){if(DOMScroll._scrollbarSize===null)DOMScroll._initScrollbarSize();return DOMScroll._scrollbarSize;},scrollTo:function(d,a,c,b){if(typeof a=='undefined'||a===true)a=750;if(!(d instanceof Vector2)){var e=Vector2.getScrollPosition().x;var f=Vector2.getElementPosition($(d)).y;f=f-Math.min(0,Math.max(Vector2.getViewportDimensions().y/3,100));d=new Vector2(e,f,'document');}if(c){d.y-=Vector2.getViewportDimensions().y/2;}else if(b){d.y-=Vector2.getViewportDimensions().y;d.y+=b;}d=d.convertTo('document');if(a){Bootloader.loadComponents('animation',function(){var g=document.body;animation(g).to('scrollTop',d.y).to('scrollLeft',d.x).ease(animation.ease.end).duration(a).go();});}else if(window.scrollTo)window.scrollTo(d.x,d.y);}};
function ElementController(){this.handlers=[[],[]];}copy_properties(ElementController,{ALL:1,TARGETS:2,MODIFIERS:4,BUTTONS:8});ElementController.prototype={initialize:function(){this.initialize=bagofholding;onloadRegister(this.register.bind(this));},handle:function(e,event,a){a=a||bagof(true);var b=this.handlers[0].concat(this.handlers[1]);for(var c=0,d=b.length;c<d;c++)if(a(b[c].filters,e,event)&&b[c].callback(e,event)===false)return event.kill();},_registerHandler:function(b,a,c,d){this.initialize();b[d?'unshift':'push']({callback:a,filters:c||0});},registerHandler:function(a,b,c){this._registerHandler(this.handlers[0],a,b,c);},registerFallbackHandler:function(a,b,c){this._registerHandler(this.handlers[1],a,b,c);}};var LinkController=new ElementController();copy_properties(LinkController,{key:'LinkControllerHandler',register:function(){Event.listen(document.documentElement,'mousedown',this.handler.bind(this));Event.listen(document.documentElement,'keydown',this.handler.bind(this));},handler:function(event){var b=Parent.byTag(event.getTarget(),'a');var a=b&&b.getAttribute('href',2);if(!a||b.rel||!this.usesWebProtocol(a)||DataStore.get(b,this.key))return;DataStore.set(b,this.key,Event.listen(b,'click',function(event){if(a.charAt(a.length-1)=='#'){event.prevent();return;}this.handle(b,event,this.filter);}.bind(this)));},filter:function(a,b,event){if(a&ElementController.ALL)return true;if((!(a&ElementController.TARGETS)&&b.target)||(!(a&ElementController.MODIFIERS)&&event.getModifiers().any)||(!(a&ElementController.BUTTONS)&&ua.safari()>=525&&event.which!=1))return false;return true;},usesWebProtocol:function(a){var b=a.match(/^(\w+):/);return !b||b[1].match(/^http/i);}});var FormController=new ElementController();copy_properties(FormController,{register:function(){Event.listen(document.documentElement,'submit',this.handler.bind(this));},handler:function(event){user_action(event.getTarget(),'form',event);return this.handle(event.getTarget(),event);}});
var DocumentTitle=(function(g){var a=1500;var f=[];var e=0;var c=null;var d=true;function b(){if(f.length>0){if(d){DocumentTitle.set(f[e].title,true);e=++e%f.length;d=false;}else DocumentTitle.reset();}else{clearInterval(c);c=null;DocumentTitle.reset();}}return {get:function(){return g;},set:function(h,i){document.title=h;if(!i){g=h;Arbiter.inform('update_title',h);}},reset:function(){DocumentTitle.set(DocumentTitle.get(),true);d=true;},blink:function(i){var h={title:i};f.push(h);if(c===null)c=b.recur(a);return {stop:function(){var j=f.indexOf(h);if(j>=0){f.splice(j,1);if(e>j)e--;}}};}};})(document.title);
function AjaxPipeRequest(b,a){this._uri=b;this._query_data=a;this._request=new AsyncRequest();this._canvas_id=null;this._allow_cross_page_transition=true;this._replayable=false;}copy_properties(AjaxPipeRequest.prototype,{setCanvasId:function(a){this._canvas_id=a;return this;},setURI:function(a){this._uri=a;return this;},setData:function(a){this._query_data=a;return this;},setAllowCrossPageTransition:function(a){this._allow_cross_page_transition=a;return this;},setAppend:function(a){this._append=a;return this;},send:function(){this._request.setOption('useIframeTransport',true).setURI(this._uri).setData(copy_properties({ajaxpipe:1},this._query_data)).setPreBootloadHandler(this._preBootloadHandler.bind(this)).setInitialHandler(this._onInitialResponse.bind(this)).setHandler(this._onResponse.bind(this)).setReplayable(this._replayable).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(this._allow_cross_page_transition);AjaxPipeRequest._current_request=this._request;this._request.send();return this;},_preBootloadFirstResponse:function(a){return false;},_fireDomContentCallback:function(){this._arbiter.inform('ajaxpipe/domcontent_callback',true,Arbiter.BEHAVIOR_STATE);},_fireOnloadCallback:function(){this._arbiter.inform('ajaxpipe/onload_callback',true,Arbiter.BEHAVIOR_STATE);},_isRelevant:function(a){return this._request==AjaxPipeRequest._current_request||a.isReplay()||this._jsNonBlock;},_preBootloadHandler:function(b){var a=b.getPayload();if(!a||a.redirect||!this._isRelevant(b))return false;var c=false;if(b.is_first){!this._append&&AjaxPipeRequest.clearCanvas(this._canvas_id);this._arbiter=new Arbiter();c=this._preBootloadFirstResponse(b);this._arbiter.registerCallback(function(){this._onUIpageOnload&&this._onUIpageOnload();}.bind(this),['uipage_onload']);this.pipe=new BigPipe({arbiter:this._arbiter,rootNodeID:this._canvas_id,lid:this._request.lid,rrEnabled:b.payload.roadrunner_enabled,isAjax:true,domContentCallback:this._fireDomContentCallback.bind(this),onloadCallback:this._fireOnloadCallback.bind(this),domContentEvt:'ajaxpipe/domcontent_callback',onloadEvt:'ajaxpipe/onload_callback',isReplay:b.isReplay(),jsNonBlock:this._jsNonBlock});}return c;},_redirect:function(a){return false;},_versionCheck:function(a){return true;},_onInitialResponse:function(b){var a=b.getPayload();if(!this._isRelevant(b))return false;if(!a)return true;if(this._redirect(a)||!this._versionCheck(a))return false;return true;},_processFirstPayload:function(a){if(ge(this._canvas_id)&&a.canvas_class!==null)CSS.setClass(this._canvas_id,a.canvas_class);},_onResponse:function(b){var a=b.payload;if(!this._isRelevant(b))return AsyncRequest.suppressOnloadToken;if(b.is_first){this._processFirstPayload(a);a.provides=a.provides||[];a.provides.push('uipage_onload');if(this._append)a.append=this._canvas_id;}if(!b.is_last||b.is_first){if(this._canvas_id===null){delete a.content;}else if('content' in a.content&&this._canvas_id!='content'){a.content[this._canvas_id]=a.content.content;delete a.content.content;}this.pipe.onPageletArrive(a);}if(b.is_last)AjaxPipeRequest.restoreCanvas(this._canvas_id);return AsyncRequest.suppressOnloadToken;},setFinallyHandler:function(a){this._request.setFinallyHandler(a);return this;},setErrorHandler:function(a){this._request.setErrorHandler(a);return this;},abort:function(){this._request.abort();if(AjaxPipeRequest._current_request==this._request)AjaxPipeRequest._current_request=null;this._request=null;return this;},setReplayable:function(a){this._replayable=a;return this;},setJSNonBlock:function(a){this._jsNonBlock=a;return this;}});copy_properties(AjaxPipeRequest,{clearCanvas:function(a){var b=ge(a);if(b){b.style.minHeight='600px';DOM.empty(b);}},restoreCanvas:function(a){var b=ge(a);if(b)b.style.minHeight='100px';},getCurrentRequest:function(){return AjaxPipeRequest._current_request;},setCurrentRequest:function(a){AjaxPipeRequest._current_request=a;},isActiveOnPage:function(b){if(!env_get('ajaxpipe_enabled'))return false;var a=new RegExp(env_get('ajaxpipe_inactive_page_regex')||null);return !a.test(URI(b).getPath());}});
_PERSISTENT_BACKENDS={localstorage:LocalStorage};function LocalStorage(){this._store=window.localStorage;}LocalStorage.available=function(){return window.localStorage?true:false;};copy_properties(LocalStorage.prototype,{keys:function(){var b=[];for(var a=0;a<this._store.length;a++)b.push(this._store.key(a));return b;},get:function(a){return this._store.getItem(a);},set:function(a,b){this._store.setItem(a,b);},remove:function(a){this._store.removeItem(a);},clear:function(){this._store.clear();}});function CacheStorage(d,b){this._key_prefix=b||'_cs_';this._magic_prefix='_@_';if(d=='AUTO')for(var c in _PERSISTENT_BACKENDS){var a=_PERSISTENT_BACKENDS[c];if(a.available()){d=c;break;}}if(d)if(!_PERSISTENT_BACKENDS[d]){this._backend=null;}else this._backend=new _PERSISTENT_BACKENDS[d]();this._memcache={};}copy_properties(CacheStorage.prototype,{keys:function(){var d=[];if(this._backend){var a=this._backend.keys();for(var b=0;b<a.length;b++)if(a[b].substr(0,this._key_prefix.length)==this._key_prefix)d.push(a[b].substr(this._key_prefix.length));return d;}for(var c in this._memcache)d.push(c);return d;},set:function(b,a){this._memcache[b]=a;if(this._backend){if(typeof a=='string'){a=this._magic_prefix+a;}else a=JSON.stringify(a);this._backend.set(this._key_prefix+b,a);}},get:function(b,c){if(this._memcache[b]!==undefined)return this._memcache[b];var d=undefined;if(this._backend){var d=this._backend.get(this._key_prefix+b);if(d!==null){if(d.substr(0,this._magic_prefix.length)==this._magic_prefix){d=d.substr(this._magic_prefix.length);}else d=JSON.parse(d);this._memcache[b]=d;}else d=undefined;}if(d===undefined&&c!==undefined){d=c;this._memcache[b]=d;if(this._backend){if(typeof d=='string'){var a=this._magic_prefix+d;}else var a=JSON.stringify(d);this._backend.set(this._key_prefix+b,a);}}return d;},remove:function(a){delete this._memcache[a];if(this._backend)this._backend.remove(this._key_prefix+a);}});
function PageCache(a,b){if(this===window)return new PageCache(a,b);this._MAX_PAGE_NUM=typeof a=='undefined'?5:a;this._MAX_TTL=typeof b=='undefined'?600000:b;this._storage=new CacheStorage();}copy_properties(PageCache.prototype,{_normalizeURI:function(a){a=new URI(a);if(a.getPath()=='/')a.setPath('/home.php');return a.getUnqualifiedURI().setFragment('').removeQueryData('ref').toString();},addPage:function(c,b){c=this._normalizeURI(c);var a=this._storage.get(c,{});a.normalized_uri=new URI(c);copy_properties(a,b);a.accessTime=a.genTime=(new Date()).getTime();this._clearCache();},updatePage:function(c,a){c=this._normalizeURI(c);var b=this._storage.get(c);if(typeof b==='undefined')return;copy_properties(b,a);this._storage.set(c,b);},isPageInCache:function(b){var a=this._storage.get(this._normalizeURI(b));return (typeof a!=='undefined');},invalidatePage:function(a){a=this._normalizeURI(a);this._storage.remove(a);},getPage:function(b){this._clearCache();b=this._normalizeURI(b);var a=this._storage.get(b);if(typeof a==='undefined')return null;a.accessTime=(new Date()).getTime();return a;},getPageUris:function(){return this._storage.keys();},_clearCache:function(){var b=(new Date()).getTime();var d=null;var f=0;var a=this._storage.keys();for(var c=0;c<a.length;c++){var h=a[c];var e=this._storage.get(h);var g=e.ttl||this._MAX_TTL;if(e.genTime<b-g){this._storage.remove(h);continue;}if(!d||this._storage.get(d).accessTime>e.accessTime)d=h;f++;}if(f>this._MAX_PAGE_NUM&&d)this._storage.remove(d);}});
var HistoryManager=window.HistoryManager||{_IFRAME_BASE_URI:'http://static.ak.facebook.com/common/history_manager.php',history:null,current:0,fragment:null,_setIframeSrcFragment:function(b){b=b.toString();var a=HistoryManager.history.length-1;HistoryManager.iframe.src=HistoryManager._IFRAME_BASE_URI+'?|index='+a+'#'+encodeURIComponent(b);return HistoryManager;},getIframeSrcFragment:function(){return decodeURIComponent(URI(HistoryManager.iframe.contentWindow.document.location.href).getFragment());},nextframe:function(a,b){if(b){HistoryManager._setIframeSrcFragment(a);return;}if(a!==undefined){HistoryManager.iframeQueue.push(a);}else{HistoryManager.iframeQueue.splice(0,1);HistoryManager.iframeTimeout=null;HistoryManager.checkURI();}if(HistoryManager.iframeQueue.length&&!HistoryManager.iframeTimeout){var c=HistoryManager.iframeQueue[0];HistoryManager.iframeTimeout=setTimeout(function(){HistoryManager._setIframeSrcFragment(c);},100,false);}},isInitialized:function(){return !!HistoryManager._initialized;},init:function(){if(!env_get('ALLOW_TRANSITION_IN_IFRAME')&&window!=window.top)return;if(HistoryManager._initialized)return HistoryManager;var b=URI();var a=b.getFragment()||'';if(a.charAt(0)==='!'){a=a.substr(1);b.setFragment(a);}if(URI.getRequestURI(false).getProtocol().toLowerCase()=='https')HistoryManager._IFRAME_BASE_URI='https://s-static.ak.facebook.com/common/history_manager.php';copy_properties(HistoryManager,{_initialized:true,fragment:a,orig_fragment:a,history:[b],callbacks:[],lastChanged:new Date().getTime(),canonical:URI('#'),fragmentTimeout:null,user:0,iframeTimeout:null,iframeQueue:[],enabled:true,debug:bagofholding});if(window.history&&history.pushState){this.lastURI=document.location.href;window.history.replaceState(this.lastURI,null);Event.listen(window,'popstate',function(c){if(c&&c.state&&HistoryManager.lastURI!=c.state){HistoryManager.lastURI=c.state;HistoryManager.lastChanged=(+new Date());HistoryManager.notify(URI(c.state).getUnqualifiedURI().toString());}}.bind(HistoryManager));if(ua.chrome()>5||ua.safari()>533)setInterval(HistoryManager.checkURI,42,false);if(ua.safari()<534)HistoryManager._updateRefererURI(this.lastURI);return HistoryManager;}HistoryManager._updateRefererURI(URI.getRequestURI(false));if(ua.safari()<500||ua.firefox()<2){HistoryManager.enabled=false;return HistoryManager;}if(ua.ie()<8){HistoryManager.iframe=document.createElement('iframe');copy_properties(HistoryManager.iframe.style,{width:'0',height:'0',frameborder:'0',left:'0',top:'0',position:'absolute'});onloadRegister(function(){HistoryManager._setIframeSrcFragment(a);document.body.insertBefore(HistoryManager.iframe,document.body.firstChild);});}else if('onhashchange' in window){Event.listen(window,'hashchange',function(){HistoryManager.checkURI.bind(HistoryManager).defer();});}else setInterval(HistoryManager.checkURI,42,false);return HistoryManager;},registerURIHandler:function(a){HistoryManager.callbacks.push(a);return HistoryManager;},setCanonicalLocation:function(a){HistoryManager.canonical=URI(a);return HistoryManager;},notify:function(c){if(c==HistoryManager.orig_fragment)c=HistoryManager.canonical.getFragment();for(var b=0;b<HistoryManager.callbacks.length;b++)try{if(HistoryManager.callbacks[b](c))return true;}catch(a){}return false;},checkURI:function(){if(new Date().getTime()-HistoryManager.lastChanged<400)return;if(window.history&&history.pushState){var d=URI(document.URL).removeQueryData('ref').toString();var c=URI(HistoryManager.lastURI).removeQueryData('ref').toString();if(d!=c){HistoryManager.lastChanged=(+new Date());HistoryManager.lastURI=d;if(ua.safari()<534)HistoryManager._updateRefererURI(d);HistoryManager.notify(URI(d).getUnqualifiedURI().toString());}return;}if(ua.ie()<8&&HistoryManager.iframeQueue.length)return;if(ua.safari()&&window.history.length==200){if(!HistoryManager.warned)HistoryManager.warned=true;return;}var a=URI().getFragment();if(a.charAt(0)=='!')a=a.substr(1);if(ua.ie()<8)a=HistoryManager.getIframeSrcFragment();a=a.replace(/%23/g,'#');if(a!=HistoryManager.fragment.replace(/%23/g,'#')){HistoryManager.debug([a,' vs ',HistoryManager.fragment,'whl: ',window.history.length,'QHL: ',HistoryManager.history.length].join(' '));for(var b=HistoryManager.history.length-1;b>=0;--b)if(HistoryManager.history[b].getFragment().replace(/%23/g,'#')==a)break;++HistoryManager.user;if(b>=0){HistoryManager.go(b-HistoryManager.current);}else HistoryManager.go('#'+a);--HistoryManager.user;}delete a;},_updateRefererURI:function(e){e=e.toString();if(e.charAt(0)!='/'&&e.indexOf('//')==-1)return;var d=new URI(window.location);if(d.isFacebookURI()){var a=d.getPath()+window.location.search;}else var a='';var c=URI(e).getQualifiedURI().setFragment(a).toString();var b=2048;if(c.length>b)c=c.substring(0,b)+'...';setCookie('x-referer',c);},go:function(c,e,f){if(window.history&&history.pushState){e||typeof(c)=='number';var h=URI(c).removeQueryData('ref').toString();HistoryManager.lastChanged=(+new Date());this.lastURI=h;if(f){window.history.replaceState(c,null,h);}else window.history.pushState(c,null,h);if(ua.safari()<534)HistoryManager._updateRefererURI(c);return false;}HistoryManager.debug('go: '+c);if(e===undefined)e=true;if(!HistoryManager.enabled)if(!e)return false;if(typeof(c)=='number'){if(!c)return false;var b=c+HistoryManager.current;var d=Math.max(0,Math.min(HistoryManager.history.length-1,b));HistoryManager.current=d;b=HistoryManager.history[d].getFragment()||HistoryManager.orig_fragment;b=URI(b).removeQueryData('ref').getUnqualifiedURI().toString();HistoryManager.fragment=b;HistoryManager.lastChanged=new Date().getTime();if(ua.ie()<8){if(HistoryManager.fragmentTimeout)clearTimeout(HistoryManager.fragmentTimeout);HistoryManager._temporary_fragment=b;HistoryManager.fragmentTimeout=setTimeout(function(){window.location.hash='#!'+b;delete HistoryManager._temporary_fragment;},750,false);if(!HistoryManager.user)HistoryManager.nextframe(b,f);}else if(!HistoryManager.user)go_or_replace(window.location,window.location.href.split('#')[0]+'#!'+b,f);if(e)HistoryManager.notify(b);HistoryManager._updateRefererURI(b);return false;}c=URI(c);if(c.getDomain()==URI().getDomain())c=URI('#'+c.getUnqualifiedURI());var a=HistoryManager.history[HistoryManager.current].getFragment();var g=c.getFragment();if(g==a||(a==HistoryManager.orig_fragment&&g==HistoryManager.canonical.getFragment())){if(e)HistoryManager.notify(g);HistoryManager._updateRefererURI(g);return false;}if(f)HistoryManager.current--;var i=(HistoryManager.history.length-HistoryManager.current)-1;HistoryManager.history.splice(HistoryManager.current+1,i);HistoryManager.history.push(URI(c));return HistoryManager.go(1,e,f);},getCurrentFragment:function(){var a=HistoryManager._temporary_fragment!==undefined?HistoryManager._temporary_fragment:URI.getRequestURI(false).getFragment();return a==HistoryManager.orig_fragment?HistoryManager.canonical.getFragment():a;}};var PageTransitions=window.PageTransitions||{_transition_handlers:[],_scroll_positions:{},_scroll_locked:false,isInitialized:function(){return !!PageTransitions._initialized;},_init:function(){if(!env_get('ALLOW_TRANSITION_IN_IFRAME')&&window!=window.top)return;if(PageTransitions._initialized)return PageTransitions;PageTransitions._initialized=true;var d=URI.getRequestURI(false);var a=d.getUnqualifiedURI();var e=URI(a).setFragment(null);var c=a.getFragment();if(c.charAt(0)==='!'&&e.toString()===c.substr(1))a=e;copy_properties(PageTransitions,{_current_uri:a,_most_recent_uri:a,_next_uri:a});var b;if(d.getFragment().startsWith('/')){b=d.getFragment();}else b=a;HistoryManager.init().setCanonicalLocation('#'+b).registerURIHandler(PageTransitions._historyManagerHandler);LinkController.registerFallbackHandler(PageTransitions._rewriteHref,LinkController.TARGETS|LinkController.MODIFIERS);LinkController.registerFallbackHandler(PageTransitions._onlinkclick);FormController.registerFallbackHandler(PageTransitions._onformsubmit);Event.listen(window,'scroll',function(){if(!PageTransitions._scroll_locked)PageTransitions._scroll_positions[PageTransitions._current_uri]=Vector2.getScrollPosition();});return PageTransitions;},registerHandler:function(b,a){PageTransitions._init();a=a||5;if(!PageTransitions._transition_handlers[a])PageTransitions._transition_handlers[a]=[];PageTransitions._transition_handlers[a].push(b);},getCurrentURI:function(a){if(!PageTransitions._current_uri&&!a)return new URI(PageTransitions._most_recent_uri);return new URI(PageTransitions._current_uri);},getMostRecentURI:function(){return new URI(PageTransitions._most_recent_uri);},getNextURI:function(){return new URI(PageTransitions._next_uri);},_rewriteHref:function(a){var c=a.getAttribute('href');var b=_computeRelativeURI(PageTransitions._most_recent_uri.getQualifiedURI(),c).toString();if(c!=b)a.setAttribute('href',b);},_onlinkclick:function(a){_BusyUIManager.lookBusy(a);PageTransitions.go(a.getAttribute('href'));return false;},_onformsubmit:function(a){var c=new URI(Form.getAttribute(a,'action')||''),b=_computeRelativeURI(PageTransitions._most_recent_uri,c);a.setAttribute('action',b.toString());if((Form.getAttribute(a,'method')||'GET').toUpperCase()==='GET'){PageTransitions.go(b.addQueryData(Form.serialize(a)));return false;}},go:function(d,b){var a=new URI(d).removeQueryData('quickling').getQualifiedURI();var c=a.getUnqualifiedURI();delete PageTransitions._scroll_positions[c];!b&&user_action({href:a.toString()},'uri',null,'INDIRECT');_BusyUIManager.lookBusy();PageTransitions._loadPage(a,function(e){if(e){HistoryManager.go(a.toString(),false,b);}else go_or_replace(window.location,a,b);});},_historyManagerHandler:function(a){if(a.charAt(0)!='/')return false;user_action({href:a},'h',null);PageTransitions._loadPage(new URI(a),function(b){if(!b)go_or_replace(window.location,a,true);});return true;},_loadPage:function(e,c){if(URI(e).getFragment()&&are_equal(URI(e).setFragment(null).getQualifiedURI(),URI(PageTransitions._current_uri).setFragment(null).getQualifiedURI())){PageTransitions._current_uri=PageTransitions._most_recent_uri=e;PageTransitions.restoreScrollPosition();_BusyUIManager.stopLookingBusy();return;}var d=PageTransitions._scroll_positions[PageTransitions._current_uri];PageTransitions._current_uri=null;PageTransitions._next_uri=e;if(d)DOMScroll.scrollTo(d,false);var b=function(){PageTransitions._scroll_locked=true;var f=PageTransitions._handleTransition(e);c&&c(f);};var a=_runHooks('onbeforeleavehooks');if(a){_BusyUIManager.stopLookingBusy();PageTransitions._warnBeforeLeaving(a,b);}else b();},_handleTransition:function(f){window.onbeforeleavehooks=undefined;_BusyUIManager.lookBusy();if(!f.isSameOrigin())return false;var e=window.AsyncRequest&&AsyncRequest.getLastId();Arbiter.inform("pre_page_transition",{from:PageTransitions.getMostRecentURI(),to:f});for(var b=PageTransitions._transition_handlers.length-1;b>=0;--b){var a=PageTransitions._transition_handlers[b];if(!a)continue;for(var c=a.length-1;c>=0;--c)if(a[c](f)===true){var d={sender:this,uri:f,id:e};Arbiter.inform("page_transition",d);return true;}else a.splice(c,1);}return false;},unifyURI:function(){PageTransitions._current_uri=PageTransitions._most_recent_uri=PageTransitions._next_uri;},transitionComplete:function(a){PageTransitions._executeCompletionCallback();_BusyUIManager.stopLookingBusy();PageTransitions.unifyURI();if(!a)PageTransitions.restoreScrollPosition();},_executeCompletionCallback:function(){if(PageTransitions._completionCallback)PageTransitions._completionCallback();PageTransitions._completionCallback=null;},setCompletionCallback:function(a){PageTransitions._completionCallback=a;},_warnBeforeLeaving:function(b,a){new Dialog().setTitle(_tx("Are you sure you want to leave this page?")).setBody(htmlize(b)).setButtons([{name:'leave_page',label:_tx("Leave This Page"),handler:a},{name:'continue_editing',label:_tx("Continue Editing"),className:'inputaux'}]).setModal().show();},restoreScrollPosition:function(){PageTransitions._scroll_locked=false;var c=PageTransitions._current_uri;var e=PageTransitions._scroll_positions[c];if(e){DOMScroll.scrollTo(e,false);return;}function d(f){return (f||null)&&(DOM.scry(document.body,"a[name='"+escape_js_quotes(f)+"']")[0]||ge(f));}var a=d(URI(c).getFragment());if(a){var b=Vector2.getElementPosition(a);b.x=0;DOMScroll.scrollTo(b);}}};function _computeRelativeURI(d,b){var e=new URI(),c=b;d=new URI(d);b=new URI(b);if(b.getDomain()&&!b.isFacebookURI())return c;var f=d;var a=['Protocol','Domain','Port','Path','QueryData','Fragment'];a.forEach(function(h){var g=h=='Path'&&f===d;if(g)e.setPath(_computeRelativePath(d.getPath(),b.getPath()));if(!is_empty(b['get'+h]()))f=b;if(!g)e['set'+h](f['get'+h]());});return e;}function _computeRelativePath(b,a){if(!a)return b;if(a.charAt(0)=='/')return a;var c=b.split('/').slice(0,-1);c[0]!=='';a.split('/').forEach(function(d){if(!(d=='.'))if(d=='..'){if(c.length>1)c=c.slice(0,-1);}else c.push(d);});return c.join('/');}function go_or_replace(a,d,c){var e=new URI(d);if(a.pathname=='/'&&e.getPath()!='/'&&e.isQuicklingEnabled()){var b=a.search?{}:{q:''};e=new URI().setPath('/').setQueryData(b).setFragment(e.getUnqualifiedURI()).toString();d=e.toString();}if(c&&!(ua.ie()<8)){a.replace(d);}else if(a.href==d){a.reload();}else a.href=d;}var _BusyUIManager=window._BusyUIManager||{_looking_busy:false,_original_cursors:[],lookBusy:function(a){if(a)_BusyUIManager._giveProgressCursor(a);if(_BusyUIManager._looking_busy)return;_BusyUIManager._looking_busy=true;_BusyUIManager._giveProgressCursor(document.body);},stopLookingBusy:function(){if(!_BusyUIManager._looking_busy)return;_BusyUIManager._looking_busy=false;while(_BusyUIManager._original_cursors.length){var c=_BusyUIManager._original_cursors.pop();var b=c[0];var a=c[1];if(b.style)b.style.cursor=a||'';}},_giveProgressCursor:function(a){if(!ua.safari()){_BusyUIManager._original_cursors.push([a,a.style.cursor]);a.style.cursor='progress';}}};
var Quickling=window.Quickling||{isActive:function(){return Quickling._is_active||false;},isFeatureEnabled:function(a){return Quickling._capabilities&&Quickling._capabilities[a];},init:function(c,b,a){if(Quickling._is_initialized)return;copy_properties(Quickling,{_is_initialized:true,_is_active:true,_session_length:b,_capabilities:a,_is_in_transition:false,_title_interval:false,_ie_cache_title:'',_cache_hit:false,_version:c});Quickling._instrumentTimeoutFunc('setInterval');Quickling._instrumentTimeoutFunc('setTimeout');PageTransitions.registerHandler(Quickling._transitionHandler,1);if(Quickling.isFeatureEnabled('page_cache')){Quickling._cache=new PageCache();Quickling._invalidate_msgs={};Arbiter.subscribe("pre_page_transition",Quickling._onPrePageTransition);Arbiter.subscribe(Arbiter.NEW_NOTIFICATIONS,Quickling._onNotifications);Arbiter.subscribe(AsyncRequest.REPLAYABLE_AJAX,Quickling._onReplayableAjax);Arbiter.subscribe(Arbiter.PAGECACHE_INVALIDATE,Quickling._onCacheInvalidates);}},_onPrePageTransition:function(b,a){if(Quickling.isFeatureEnabled('page_cache')&&(page=Quickling._cache.getPage(a.from))&&!page.incremental_updates){invoke_callbacks(page.onpagecache);page.refresh_pagelets.forEach(function(c){var d=Quickling._getPageletById(c);d&&d.refresh(true);});page.incremental_updates=AsyncRequest.stashBundledRequest();}},_onNotifications:function(b,a){Quickling._cache=new PageCache();Quickling._invalidate_msgs={};},_onCacheInvalidates:function(c,b){if(Quickling.isFeatureEnabled('page_cache')&&b&&b.length){for(var a=0;a<b.length;a++)if(parseInt(b[a])===0){if(Quickling._is_in_transition&&!Quickling.isFeatureEnabled('flush_cache_in_transition'))break;if(Quickling._cache.isPageInCache(PageTransitions.getMostRecentURI())&&!Quickling.isFeatureEnabled('flush_cache_in_page_write'))break;Quickling._cache=new PageCache();Quickling._invalidate_msgs={};return;}b.forEach(function(d){Quickling._invalidate_msgs[d]=1;});}},_refresh_pagelets:function(){if(is_empty(window.__listeners))return;for(var a in Quickling._invalidate_msgs)if(a in window.__listeners)window.__listeners[a].forEach(function(b){b.refresh();});},registerPageCacheHook:function(a,c){if(!Quickling._is_initialized||!Quickling._is_active||Quickling._is_in_transition||!Quickling.isFeatureEnabled('page_cache'))return;var b=PageTransitions.getMostRecentURI();var e=Quickling._cache.getPage(b);if(e){if(c)for(var d=0;d<e.replays.length;d++)if(e.replays[d][0]==c){e.replays.splice(d,1);d--;}e.replays.push([c,a]);}},_onReplayableAjax:function(c,b){if((PageTransitions.getNextURI().toString()!=PageTransitions.getMostRecentURI().toString()))return;if(Quickling._is_in_transition)return;var a=Quickling._whitelist_regex;if(!a)a=Quickling._whitelist_regex=new RegExp(env_get('pagecache_whitelist_regex'));if(a.test(URI(b.getURI()).getPath()))return;Quickling.registerPageCacheHook(bind(b,b.replayResponses),b._replayKey);},_startQuicklingTransition:function(){Quickling._is_in_transition=true;window.channelManager&&window.channelManager.setActionRequest(true);},_stopQuicklingTransition:function(){(function(){Quickling._is_in_transition=false;}).defer();},isCacheHit:function(){return Quickling._cache_hit;},goHashOrGoHere:function(d){var c=URI.getRequestURI();var b=c.getFragment();if(b.startsWith('/')){var a=b;}else var a=d;setTimeout(function(){PageTransitions.go(a,true);},0);},isPageActive:function(e){if(e=='#')return false;e=new URI(e);if(e.getDomain()&&e.getDomain()!=URI().getDomain())return false;var b=Quickling.isPageActive.regex;if(!b)b=Quickling.isPageActive.regex=new RegExp(env_get('quickling_inactive_page_regex'));if(e.getPath()=='/l.php'){var c=e.getQueryData().u;if(c){c=URI(unescape(c)).getDomain();if(c&&c!=URI().getDomain())return false;}}var d=e.getPath();var a=e.getQueryData();if(a)d+='?'+URI.implodeQuery(a);if(b.test(d))return false;return true;},_getPageletById:function(a){return window.__UIControllerRegistry&&window.__UIControllerRegistry[a];},_setHTML:function(a,b){if(ua.ie()<=6){a.innerHTML=b;}else DOM.setContent(a,HTML(b).setDeferred(true));},_transitionHandler:function(h){AjaxPipeRequest.setCurrentRequest(null);if(Quickling._isTimeToRefresh())return false;if(!Quickling.isPageActive(h))return false;window.ExitTime=(new Date()).getTime();removeHook('onafterloadhooks');removeHook('onloadhooks');_runHooks('onleavehooks');Arbiter.inform('onload/exit',true);Quickling._startQuicklingTransition();$('content').style.visibility="visible";var e;if(Quickling.isFeatureEnabled('page_cache')&&(e=Quickling._cache.getPage(h))){var d=null;var f=window.ExitTime;var g=null;var a=new Arbiter();a.registerCallback(function(){if(AjaxPipeRequest.getCurrentRequest()!==d)return;if(d)if(d.cavalry){var i=null;if(g)i=g-f;d.cavalry.setTimeStamp('t_domcontent',null,null,i);d.cavalry.setTimeStamp('t_hooks',null,null,i);d.cavalry.setTimeStamp('t_layout',null,null,i);d.cavalry.setTimeStamp('t_onload',null,null,i);}Quickling._cache_hit=true;invoke_callbacks(e.onafterload);invoke_callbacks(e.onafterpagecache);Quickling._cache_hit=false;Quickling._stopQuicklingTransition();},['pagecache_update','tti_pagecache']);d=AsyncRequest.setBundledRequestProperties({stashedRequests:e.incremental_updates,callback:function(){if(d&&d.cavalry)d.cavalry&&d.cavalry.setTimeStamp('t_html');a.inform('pagecache_update',true,Arbiter.BEHAVIOR_EVENT);},onInitialResponse:function(j){var i=j.getPayload();if(i.redirect&&i.force){return false;}else return true;},extra_data:{uri:e.normalized_uri.getQualifiedURI().toString(),version:Quickling._version},start_immediately:true});var c=$('content');c.style.visibility="hidden";AjaxPipeRequest.setCurrentRequest(d);AjaxPipeRequest.clearCanvas('content');Bootloader.loadResources(e.css.concat(e.js),null,true);Quickling._changePageTitle(e.title);Quickling._replaceSyndicationLinks(e.syndication_links||[]);var b=e.body_class||'';CSS.setClass(document.body,b);e.html=e.html.replace(/<span class=["']?muffin_tracking_pixel_start['"]?><\/span>.*?<span class=["']?muffin_tracking_pixel_end['"]?><\/span>/ig,'');Quickling._setHTML(c,e.html);if(c&&c.style.height=='1234px')c.style.height='';PageTransitions.transitionComplete(true);Quickling._cache_hit=true;invoke_callbacks(e.jscc);invoke_callbacks(e.onload);Quickling._cache_hit=false;Quickling._refresh_pagelets();e.replays.forEach(function(i){i[1]();});e.refresh_pagelets.forEach(function(i){var j=document.getElementById(i);if(j)j.innerHTML='';});setTimeout(function(){PageTransitions.restoreScrollPosition();$('content').style.visibility="visible";g=(+new Date());a.inform('tti_pagecache',true,Arbiter.BEHAVIOR_EVENT);},20);}else new QuickPipeRequest(h).setCanvasId('content').send();return true;},_changePageTitle:function(a){a=a||'Facebook';DocumentTitle.set(a);if(ua.ie()){Quickling._ie_cache_title=a;if(!Quickling._title_interval)Quickling._title_interval=window.setInterval(function(){var b=Quickling._ie_cache_title;var c=DocumentTitle.get();if(b!=c)DocumentTitle.set(b);},5000,false);}},_replaceSyndicationLinks:function(d){var c=document.getElementsByTagName('link');for(var b=0;b<c.length;++b){if(c[b].rel!='alternate')continue;DOM.remove(c[b]);}if(d.length){var a=DOM.find(document,'head');a&&DOM.appendContent(a,HTML(d[0]));}},cacheResponse:function(c,a){var b=c.payload;Quickling._cache.addPage(PageTransitions.getNextURI(),{title:b.title,syndication:b.syndication||[],body_class:b.body_class,html:b.content.content,js:b.js||[],css:b.css||[],jscc:b.jscc?[b.jscc]:[],onload:b.onload||[],onafterload:b.onafterload||[],refresh_pagelets:b.refresh_pagelets||[],onpagecache:b.onpagecache||[],onafterpagecache:b.onafterpagecache||[],ttl:b.page_cache_ttl,replays:[]});if(a){invoke_callbacks(b.onload);onafterloadRegister(function(){invoke_callbacks(b.onafterload);});}},cacheAndExecResponse:function(c,d){var a=PageTransitions.getNextURI();var b=Quickling._cache.getPage(a);if(b){if(c.html)b.html=c.html;c.jscc&&b.jscc.push(c.jscc);b.js=b.js.concat(c.js||[]);b.css=b.css.concat(c.css||[]);b.onload=b.onload.concat(c.onload||[]);b.onafterload=b.onafterload.concat(c.onafterload||[]);b.onpagecache=b.onpagecache.concat(c.onpagecache||[]);b.onafterpagecache=b.onafterpagecache.concat(c.onafterpagecache||[]);b.refresh_pagelets=b.refresh_pagelets.concat(c.refresh_pagelets||[]);}if(!d){invoke_callbacks(c.onload);onafterloadRegister(function(){invoke_callbacks(c.onafterload);});}},_isTimeToRefresh:function(){Quickling._load_count=(Quickling._load_count||0)+1;return Quickling._load_count>=Quickling._session_length;},_instrumentTimeoutFunc:function(a){window[a+'_native']=(function(c){var b=function b(e,d){return c(e,d);};return b;})(window[a]);window[a]=function _setTimeout(d,c,b){var e=window[a+'_native'](d,c);if(c>0)if(b!==false)onleaveRegister(function(){clearInterval(e);});return e;};}};function QuickPipeRequest(b){var a={version:Quickling._version};this.parent.construct(this,b,{quickling:a});}QuickPipeRequest.extend('AjaxPipeRequest');copy_properties(QuickPipeRequest.prototype,{_preBootloadFirstResponse:function(b){var a=b.getPayload();if(Quickling.isFeatureEnabled('page_cache')&&a.page_cache_ttl)this._onUIpageOnload=bind(null,Quickling.cacheResponse,b);DOMScroll.scrollTo(new Vector2(0,0,'document'),false);return true;},_fireDomContentCallback:function(){this._request.cavalry&&this._request.cavalry.setTimeStamp('t_domcontent');Quickling._stopQuicklingTransition();PageTransitions.transitionComplete();this.parent._fireDomContentCallback();},_fireOnloadCallback:function(){if(this._request.cavalry){this._request.cavalry.setTimeStamp('t_hooks');this._request.cavalry.setTimeStamp('t_layout');this._request.cavalry.setTimeStamp('t_onload');}this.parent._fireOnloadCallback();},_redirect:function(a){if(a.redirect){if(a.force||!Quickling.isPageActive(a.redirect)){go_or_replace(window.location,URI(a.redirect).removeQueryData(['quickling','ajaxpipe']),true);}else PageTransitions.go(a.redirect,true);return true;}else return false;},_versionCheck:function(a){if(a.version!=Quickling._version){go_or_replace(window.location,URI(a.uri).removeQueryData(['quickling','ajaxpipe']),true);return false;}else return true;},_processFirstPayload:function(b){Quickling._changePageTitle(b.title);Quickling._replaceSyndicationLinks(b.syndication||[]);var a=b.body_class||'';CSS.setClass(document.body,a);if(b.hasOnbeforeshow)$('content').style.visibility='hidden';}});function onpagecacheRegister(a,b){b=(b===undefined?'':String(b));Quickling.registerPageCacheHook(a,b);}

if (window.Bootloader) { Bootloader.done(["7Ch5B"]); }