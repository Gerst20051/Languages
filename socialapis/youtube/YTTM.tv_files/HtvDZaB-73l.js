/*1298588530,169775555*/

if (window.CavalryLogger) { CavalryLogger.start_js(["RC+QD"]); }

function Toggler(){this.init();}(function(){var d=[];var b;function c(){c=bagofholding;Event.listen(document.documentElement,'click',function(event){var e=event.getTarget();d.each(function(f){f.active&&!f.sticky&&!DOM.contains(f.getActive(),e)&&f.hide();});},Event.Priority.URGENT);}function a(f,e){if(f instanceof Toggler)return f;return Toggler.getInstance(e);}Toggler.mixin('Arbiter',{init:function(){this.active=null;this.togglers={};this.setSticky(false);d.push(this);this.subscribe(['show','hide'],Toggler.inform.bind(Toggler));c();},show:function(f){var e=a(this,f);var g=e.active;if(f!==g){g&&e.hide();e.active=f;CSS.addClass(f,'openToggler');DOM.appendContent(f,e.getToggler('next'));DOM.prependContent(f,e.getToggler('prev'));e.inform('show',e);}},hide:function(g){var f=a(this,g);var e=f.active;if(e&&(!g||g===e)){CSS.removeClass(e,'openToggler');values(f.togglers).each(DOM.remove);f.inform('hide',f);f.active=null;}},toggle:function(f){var e=a(this,f);if(e.active===f){e.hide();}else e.show(f);},getActive:function(){return a(this).active;},getToggler:function(f){var e=a(this);if(!e.togglers[f])e.togglers[f]=$N('button',{className:'hideToggler',onfocus:function(){var g=DOM.scry(e.active,'[rel="toggle"]')[0];g&&g.focus();e.hide();}});return this.togglers[f];},setSticky:function(f){var e=a(this);f=f!==false;if(f!==e.sticky){e.sticky=f;if(f){e._pt&&Arbiter.unsubscribe(e._pt);}else e._pt=Arbiter.subscribe('page_transition',e.hide.bind(e,null));}return e;}});copy_properties(Toggler,Toggler.prototype);copy_properties(Toggler,{bootstrap:function(e){var f=e.parentNode;Toggler.getInstance(f).toggle(f);},createInstance:function(f){var e=new Toggler().setSticky(true);DataStore.set(f,'toggler',e);return e;},getInstance:function(f){while(f){var e=DataStore.get(f,'toggler');if(e)return e;f=f.parentNode;}return (b=b||new Toggler());},listen:function(g,f,e){return Toggler.subscribe($A(g),function(i,h){if(h.getActive()===f)return e(i,h);});},subscribe:(function(e){return function(g,f){g=$A(g);if(g.contains('show'))d.each(function(h){if(h.getActive())f.curry('show',h).defer();});return e(g,f);};})(Toggler.subscribe.bind(Toggler))});})();
var Menu=function(){var i='menu:mouseover';var a=null;function b(k){return Parent.byClass(k,'uiMenu');}function c(k){return Parent.byClass(k,'uiMenuItem');}function d(k){if(document.activeElement){var l=c(document.activeElement);return k.indexOf(l);}return -1;}function e(k){return DOM.find(k,'a.itemAnchor');}function f(k){return CSS.hasClass(k,'checked');}function g(k){return !CSS.hasClass(k,'disabled');}function h(event){var k=c(event.getTarget());k&&Menu.focusItem(k);}function j(k){Menu.inform(Menu.ITEM_SELECTED,{menu:b(k),item:k});}onloadRegister(function(){var k={};k.click=function(event){var n=c(event.getTarget());if(n&&g(n)){j(n);var l=e(n);var m=l.href;var o=l.getAttribute('rel');return (o&&o!=='ignore')||(m&&m.charAt(m.length-1)!=='#');}};k.keydown=function(event){var u=event.getTarget();if(!a||DOM.isNode(u,['input','textarea']))return;var q=Event.getKeyCode(event);switch(q){case KEYS.UP:case KEYS.DOWN:var m=Menu.getEnabledItems(a);var o=d(m);Menu.focusItem(m[o+(q===KEYS.UP?-1:1)]);return false;case KEYS.SPACE:var t=c(u);if(t){j(t);event.prevent();}break;default:var l=String.fromCharCode(q).toLowerCase();var p=Menu.getEnabledItems(a);var o=d(p);var n=o;var r=p.length;while((~o&&(n=++n%r)!==o)||(!~o&&++n<r)){var s=Menu.getItemLabel(p[n]);if(s&&s.charAt(0).toLowerCase()===l){Menu.focusItem(p[n]);return false;}}}};Event.listen(document.body,k);});return copy_properties(new Arbiter(),{ITEM_SELECTED:'menu/item-selected',ITEM_TOGGLED:'menu/item-toggled',focusItem:function(k){if(k){this._removeSelected(b(k));CSS.addClass(k,'selected');g(k)&&e(k).focus();}},getEnabledItems:function(k){return Menu.getItems(k).filter(g);},getCheckedItems:function(k){return Menu.getItems(k).filter(f);},getItems:function(k){return DOM.scry(k,'li.uiMenuItem');},getItemLabel:function(k){return k.getAttribute('data-label',2)||'';},isItemChecked:function(k){return CSS.hasClass(k,'checked');},register:function(k){k=b(k);if(!DataStore.get(k,i))DataStore.set(k,i,Event.listen(k,'mouseover',h));a=k;},setItemEnabled:function(l,k){if(!k&&!DOM.scry(l,'span.disabledAnchor')[0])DOM.appendContent(l,$N('span',{className:'itemAnchor disabledAnchor'},HTML(e(l).innerHTML)));CSS.conditionClass(l,'disabled',!k);},toggleItem:function(l){var k=!Menu.isItemChecked(l);CSS.conditionClass(l,'checked',k);e(l).setAttribute('aria-checked',k);Menu.inform(Menu.ITEM_TOGGLED,{menu:b(l),item:l,checked:k});},unregister:function(l){l=b(l);var k=DataStore.remove(l,i);k&&k.remove();a=null;this._removeSelected(l);},_removeSelected:function(k){Menu.getItems(k).filter(function(l){return CSS.hasClass(l,'selected');}).each(function(l){CSS.removeClass(l,'selected');});}});}();
var TooltipLink={setTooltipText:function(a,b){a=Parent.byClass(a,'uiTooltip');if(a)DOM.setContent(DOM.find(a,'span.uiTooltipText'),HTML(b));},setTooltipEnabled:function(b,a){b=Parent.byClass(b,'uiTooltip');b&&CSS.conditionClass(b,'uiTooltipDisabled',!a);}};
var Selector=function(){var a;var k=false;function b(m){return Parent.byClass(m,'uiSelector');}function c(m){return Parent.byClass(m,'uiSelectorButton');}function d(m){return DOM.find(m,'a.uiSelectorButton');}function g(m){return DOM.scry(m,'select')[0];}function e(m){return DOM.scry(m,'ul.uiSelectorMenu')[0];}function f(m){return DOM.find(m,'div.uiSelectorMenuWrapper');}function h(){h=bagofholding;Menu.subscribe(Menu.ITEM_SELECTED,function(m,o){if(!a||!o||o.menu!==e(a))return;var p=i(a);var r=j(o.item);if(r){var n=a;var s=Selector.inform('select',{selector:n,option:o.item});if(s===false)return;var q=Selector.isOptionSelected(o.item);if(p||!q){Selector.setSelected(n,Selector.getOptionValue(o.item),!q);Selector.inform('toggle',{selector:n,option:o.item});Selector.inform('change',{selector:n});if(l(n))DataStore.set(n,'dirty',true);}}if(!p||!r)a&&Selector.toggle(a);});}function i(m){return !!m.getAttribute('data-multiple');}function j(m){return CSS.hasClass(m,'uiSelectorOption');}function l(m){return !!m.getAttribute('data-autosubmit');}onloadRegister(function(){var m={};m.keydown=function(event){var o=event.getTarget();if(DOM.isNode(o,['input','textarea']))return;switch(Event.getKeyCode(event)){case KEYS.DOWN:case KEYS.SPACE:case KEYS.UP:k=true;if(c(o)){var n=b(o);Selector.toggle(n);return false;}break;case KEYS.ESC:k=true;if(a){Selector.toggle(a);return false;}break;case KEYS.RETURN:k=true;break;}};m.keyup=function(){!function(){k=false;}.defer();};Event.listen(document.body,m);Toggler.subscribe(['show','hide'],function(v,u){var r=b(u.getActive());if(r){h();var o=d(r);var p=e(r);var s=v==='show';if(s){a=r;if(CSS.hasClass(o,'uiButtonDisabled')){Selector.setEnabled(r,false);return false;}if(!p){var n=o.getAttribute('ajaxify');if(n){var w=HTML('<div class="uiSelectorMenuWrapper">'+'<ul class="uiMenu uiSelectorMenu loading">'+'<li><span></span></li>'+'</ul>'+'</div>');DOM.appendContent(o.parentNode,w);Bootloader.loadComponents('async',function(){AsyncRequest.bootstrap(n,o);});p=e(r);}}if(p){Menu.register(p);if(k){var q=Menu.getCheckedItems(p);if(!q.length)q=Menu.getEnabledItems(p);Menu.focusItem(q[0]);}}}else{a=null;p&&Menu.unregister(p);k&&o.focus();if(l(r)&&DataStore.get(r,'dirty')){var t=DOM.scry(r,'input.submitButton')[0];t&&t.click();DataStore.remove(r,'dirty');}}CSS.conditionClass(d(r),'selected',s);Selector.inform(s?'open':'close',{selector:r});}});});return copy_properties(new Arbiter(),{attachMenu:function(q,m,o){q=b(q);if(q){a&&Menu.unregister(e(a));DOM.setContent(f(q),m);a&&Menu.register(e(q));if(o){var p=g(q);if(p){DOM.replace(p,o);}else DOM.insertAfter(q.firstChild,o);var n=q.getAttribute('data-name');n&&g(q).setAttribute('name',n);}return true;}},getOption:function(o,p){var n=Selector.getOptions(o),m=n.length;while(m--)if(p===Selector.getOptionValue(n[m]))return n[m];return null;},getOptions:function(n){var m=Menu.getItems(e(n));return m.filter(j);},getEnabledOptions:function(n){var m=Menu.getEnabledItems(e(n));return m.filter(j);},getSelectedOptions:function(m){return Menu.getCheckedItems(e(m));},getOptionText:function(m){return Menu.getItemLabel(m);},getOptionValue:function(n){var p=b(n);var o=g(p);var m=Selector.getOptions(p).indexOf(n);return m>=0?o.options[m+1].value:'';},getValue:function(q){var o=g(q);if(!o)return null;if(!i(q))return o.value;var r=[];var n=o.options;for(var m=1,p=n.length;m<p;m++)if(n[m].selected)r.push(n[m].value);return r;},isOptionSelected:function(m){return Menu.isItemChecked(m);},listen:function(n,o,m){return this.subscribe(o,function(q,p){if(p.selector===n)return m(p,q);});},setButtonLabel:function(p,n){var m=d(p);var o=parseInt(m.getAttribute('data-length'),10);n=n||m.getAttribute('data-label')||'';Button.setLabel(m,n);if(typeof n==='string'){CSS.conditionClass(m,'uiSelectorBigButtonLabel',n.length>o);if(o&&n.length>o){m.setAttribute('title',n);}else m.removeAttribute('title');}},setButtonTooltip:function(o,n){var m=d(o);TooltipLink.setTooltipText(m,n||m.getAttribute('data-tooltip')||'');},setEnabled:function(n,m){if(!m&&a&&b(n)===a)Selector.toggle(n);Button.setEnabled(d(n),m);},setOptionEnabled:function(n,m){Menu.setItemEnabled(n,m);},setSelected:function(q,r,o){o=o!==false;var n=Selector.getOption(q,r);if(!n)return;var m=Selector.isOptionSelected(n);if(o!==m){if(!i(q)&&!m){var p=Selector.getSelectedOptions(q)[0];p&&Menu.toggleItem(p);}Menu.toggleItem(n);Selector.updateSelector(q);}},toggle:function(m){Toggler.toggle(DOM.scry(b(m),'div.wrap')[0]);},updateSelector:function(v){var s=Selector.getOptions(v);var u=Selector.getSelectedOptions(v);var p=g(v).options;var r=[];for(var o=0,q=s.length;o<q;o++){var t=u.contains(s[o]);p[o+1].selected=t;if(t)r.push(Selector.getOptionText(s[o]));}p[0].selected=!u.length;var m=CSS.hasClass(v,'uiSelectorDynamicLabel');var n=CSS.hasClass(v,'uiSelectorDynamicTooltip');if(m||n){r=r.join(i(v)?d(v).getAttribute('data-delimiter'):'');m&&Selector.setButtonLabel(v,r);n&&Selector.setButtonTooltip(v,r);}}});}();

if (window.Bootloader) { Bootloader.done(["RC+QD"]); }