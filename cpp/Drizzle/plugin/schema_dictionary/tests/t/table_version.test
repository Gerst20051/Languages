# We test that version increments, and that when dropped version number is
# not reused.
CREATE TABLE version_test (a int);
SELECT TABLE_VERSION FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

SELECT TABLE_UUID INTO @current_table_uuid FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

ALTER TABLE version_test ADD COLUMN b int;
SELECT TABLE_VERSION FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

SELECT COUNT(*) FROM DATA_DICTIONARY.TABLES WHERE TABLE_UUID = @current_table_uuid;

ALTER TABLE version_test ADD COLUMN c int;
SELECT TABLE_VERSION FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

SELECT COUNT(*) FROM DATA_DICTIONARY.TABLES WHERE TABLE_UUID = @current_table_uuid;

DROP TABLE VERSION_test;
SELECT TABLE_VERSION FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

CREATE TABLE version_test (a int);
SELECT TABLE_VERSION FROM DATA_DICTIONARY.TABLES WHERE TABLE_NAME="version_test";

# Just make sure UUID is not reused.
SELECT COUNT(*) FROM DATA_DICTIONARY.TABLES WHERE TABLE_UUID = @current_schema_uuid;

DROP TABLE VERSION_test;
