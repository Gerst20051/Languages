CREATE TABLE t1 (a int) ENGINE=storage_engine_api_tester;
SELECT SEAPITESTER_ERROR_INJECT(2);
SET AUTOCOMMIT=OFF;
START TRANSACTION;
INSERT INTO t1 VALUES (1);
SAVEPOINT A;
SELECT * FROM DATA_DICTIONARY.USER_DEFINED_SAVEPOINTS;
--error ER_LOCK_DEADLOCK
INSERT INTO t1 VALUES (2);
SELECT * FROM DATA_DICTIONARY.USER_DEFINED_SAVEPOINTS;
SAVEPOINT A;
SELECT * FROM DATA_DICTIONARY.USER_DEFINED_SAVEPOINTS;
ROLLBACK;
SELECT SEAPITESTER_ERROR_INJECT(0);
commit;
DROP TABLE t1;
