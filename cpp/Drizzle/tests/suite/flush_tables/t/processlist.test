connect (con1,localhost,root,,);

# Make sure that we show as the connection in processlist which has the
# global lock.
connection default;
SELECT HAS_GLOBAL_LOCK from DATA_DICTIONARY.PROCESSLIST WHERE ID = CONNECTION_ID();
FLUSH TABLES WITH READ LOCK;
SELECT HAS_GLOBAL_LOCK from DATA_DICTIONARY.PROCESSLIST WHERE ID = CONNECTION_ID();

connection con1;
SELECT if ((ID = CONNECTION_ID()), "YES", "NO"), HAS_GLOBAL_LOCK from DATA_DICTIONARY.PROCESSLIST WHERE ID = CONNECTION_ID();

connection default;
SELECT if ((ID = CONNECTION_ID()), "YES", "NO"), HAS_GLOBAL_LOCK from DATA_DICTIONARY.PROCESSLIST WHERE ID = CONNECTION_ID();
UNLOCK TABLES;
SELECT if ((ID = CONNECTION_ID()), "YES", "NO"), HAS_GLOBAL_LOCK from DATA_DICTIONARY.PROCESSLIST WHERE ID = CONNECTION_ID();

